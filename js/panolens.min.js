(function(p,e){"object"===typeof exports&&"undefined"!==typeof module?e(exports,require("three")):"function"===typeof define&&define.amd?define(["exports","three"],e):(p=p||self,e(p.PANOLENS={},p.THREE))})(this,function(p,e){function O(a,b,c){a=void 0===a?16777215:a;b=void 0===b?!0:b;c=void 0===c?1500:c;this.dpr=window.devicePixelRatio;var d=this.createCanvas(),g=d.canvas;d=d.context;var l=new e.SpriteMaterial({color:a,map:this.createCanvasTexture(g)});e.Sprite.call(this,l);this.canvasWidth=g.width;
this.canvasHeight=g.height;this.context=d;this.color=a instanceof e.Color?a:new e.Color(a);this.autoSelect=b;this.dwellTime=c;this.rippleDuration=500;this.position.z=-10;this.center.set(.5,.5);this.scale.set(.5,.5,1);this.callback=this.timerId=this.startTimestamp=null;this.frustumCulled=!1;this.updateCanvasArcByProgress(0)}function B(a,b,c){a=void 0===a?300:a;b=b||F.Info;e.Sprite.call(this);this.type="infospot";this.animated=void 0!==c?c:!0;this.frustumCulled=this.isHovering=!1;this.cursorStyle=this.toPanorama=
this.element=null;this.mode=u.NORMAL;this.loaded=!1;this.scale.set(a,a,1);this.rotation.y=Math.PI;this.container=null;this.originalRaycast=this.raycast;this.HANDLER_FOCUS=null;this.material.side=e.DoubleSide;this.material.depthTest=!1;this.material.transparent=!0;this.material.opacity=0;this.scaleUpAnimation=new h.Tween;this.scaleDownAnimation=new h.Tween;c=function(d){if(this.material){this.material.map=d;this.material.needsUpdate=!0;this.loaded=this.material.map.needsUpdate=!0;this._parentRatio||
(this._parentRatio=1);var b=d.image.width/d.image.height,c=new e.Vector3;d.image.width=d.image.naturalWidth||64;d.image.height=d.image.naturalHeight||64;this.scale.set(b/this._parentRatio*a,a,1);this.material.needsUpdate=!0;this.material.map.needsUpdate=!0;c.copy(this.scale);this.scaleUpAnimation=(new h.Tween(this.scale)).to({x:1.3*c.x,y:1.3*c.y},500).easing(h.Easing.Elastic.Out);this.scaleDownAnimation=(new h.Tween(this.scale)).to({x:c.x,y:c.y},500).easing(h.Easing.Elastic.Out);this.show(500)}}.bind(this);
this.showAnimation=(new h.Tween(this.material)).to({opacity:1},500).onStart(this.enableRaycast.bind(this,!0)).easing(h.Easing.Quartic.Out);this.hideAnimation=(new h.Tween(this.material)).to({opacity:0},500).onStart(this.enableRaycast.bind(this,!1)).easing(h.Easing.Quartic.Out);this.addEventListener("click",this.onClick);this.addEventListener("hover",this.onHover);this.addEventListener("hoverenter",this.onHoverStart);this.addEventListener("hoverleave",this.onHoverEnd);this.addEventListener("panolens-dual-eye-effect",
this.onDualEyeEffect);this.addEventListener("panolens-container",this.setContainer.bind(this));this.addEventListener("dismiss",this.onDismiss);this.addEventListener("panolens-infospot-focus",this.setFocusMethod);M.load(b,c)}function n(){this.edgeLength=1E4;e.Mesh.call(this,this.createGeometry(this.edgeLength),this.createMaterial());this.type="panorama";this.ImageQualityLow=1;this.ImageQualityFair=2;this.ImageQualityMedium=3;this.ImageQualityHigh=4;this.ImageQualitySuperHigh=5;this.animationDuration=
1E3;this.defaultInfospotSize=350;this.container=void 0;this.loaded=!1;this.linkedSpots=[];this.isInfospotVisible=!1;this.linkingImageScale=this.linkingImageURL=void 0;this.scale.x*=-1;this.renderOrder=-1;this.active=this.visible=!1;this.infospotAnimation=(new h.Tween(this)).to({},this.animationDuration/2);this.addEventListener("panolens-container",this.setContainer.bind(this));this.addEventListener("click",this.onClick.bind(this));this.setupTransitions()}function v(a){n.call(this);this.src=a;this.type=
"image_panorama"}function V(){var a=new e.BufferGeometry,b=new e.MeshBasicMaterial({color:0,opacity:0,transparent:!0});a.addAttribute("position",new e.BufferAttribute(new Float32Array,1));n.call(this,a,b)}function N(a){a=void 0===a?[]:a;n.call(this);this.images=a;this.type="cube_panorama"}function W(){for(var a=[],b=0;6>b;b++)a.push(F.WhiteTile);N.call(this,a);this.type="basic_panorama"}function K(a,b){b=void 0===b?{x:0,y:0,z:0}:b;this.subtype="slider_panorama";this.src=a;this.desiredWidth=a.width;
this.desiredHeight=a.height;n.call(this);this.desiredPosition=b}function G(a,b){"image"===(void 0===a?"image":a)&&v.call(this,b);this.EPS=1E-6;this.frameId=null;this.dragging=!1;this.userMouse=new e.Vector2;this.quatA=new e.Quaternion;this.quatB=new e.Quaternion;this.quatCur=new e.Quaternion;this.quatSlerp=new e.Quaternion;this.vectorX=new e.Vector3(1,0,0);this.vectorY=new e.Vector3(0,1,0);this.type="little_planet";this.addEventListener("window-resize",this.onWindowResize)}function X(a,b){P.uniforms.threshold.value=
a.threshold;P.uniforms.useTexture.value=a.useTexture;P.uniforms.tMixTexture.value=b;return new e.ShaderMaterial(P)}function Y(a,b,c,d,g){var l=this;g=void 0===g?!1:g;var k={CROSSFADE:{id:0,label:"Crossfade",value:"crossfade",settings:{useTexture:!1,texture:3,transitionSpeed:-2,smoothstep:{start:.3,end:.7}}},PERLIN:{id:1,label:"Perlin",value:"perlin",settings:{useTexture:!0,texture:1,transitionSpeed:-2,smoothstep:{start:.3,end:.7}}},SQUARES:{id:2,label:"Squares",value:"squares",settings:{useTexture:!0,
texture:2,transitionSpeed:-2,smoothstep:{start:.3,end:.7}}},CELLS:{id:3,label:"Cells",value:"cells",settings:{useTexture:!0,texture:3,transitionSpeed:-2,smoothstep:{start:.3,end:.7}}},DISTORT:{id:4,label:"Distort",value:"distort",settings:{useTexture:!0,texture:4,transitionSpeed:-2,smoothstep:{start:.3,end:.7}}},GRADIENT:{id:5,label:"Gradient",value:"gradient",settings:{useTexture:!0,texture:5,transitionSpeed:-2,smoothstep:{start:.3,end:.7}}},RADIAL:{id:6,label:"Radial",value:"radial",settings:{useTexture:!0,
texture:6,transitionSpeed:-2,smoothstep:{start:.3,end:.7}}},PARALLAX:{id:7,label:"Parallax",value:"parallax",settings:{useTexture:!1,texture:3,transitionSpeed:-3,smoothstep:{start:.3,end:.7}}},NONE:{id:8,label:"None",value:"none",settings:{useTexture:!1,texture:0,transitionSpeed:-1E4,smoothstep:{start:.3,end:.7}}}};this.getTypeList=function(){return Object.keys(k).map(function(a){return Object.assign({},k[a])}).sort(function(a,d){return a.id-d.id})};this.getTypeRelatedParameters=function(a){switch(a){case k.PERLIN.value:return Object.assign({},
k.PERLIN.settings);case k.SQUARES.value:return Object.assign({},k.SQUARES.settings);case k.CELLS.value:return Object.assign({},k.CELLS.settings);case k.DISTORT.value:return Object.assign({},k.DISTORT.settings);case k.GRADIENT.value:return Object.assign({},k.GRADIENT.settings);case k.RADIAL.value:return Object.assign({},k.RADIAL.settings);case k.PARALLAX.value:return Object.assign({},k.PARALLAX.settings);case k.NONE.value:return Object.assign({},k.NONE.settings);default:return Object.assign({},k.CROSSFADE.settings)}};
this.updateParams=function(a){var d=this.getTypeRelatedParameters(a&&a.type||k.CROSSFADE.value);this.transitionParams=Object.assign({textureThreshold:.3},k.CROSSFADE.settings,a,d)};this.updateParams(d);this.transition=1;this.isInitiatorInfospot=g;this.clock=new e.Clock;this.transitionScene=new e.Scene;this.cameraOrtho=new e.OrthographicCamera(window.innerWidth/-2,window.innerWidth/2,window.innerHeight/2,window.innerHeight/-2,-10,10);this.texture=(new e.TextureLoader).load("/public/panolens/textures/transition/transition"+
this.transitionParams.texture+".png");this.quadmaterial=new X(this.transitionParams,this.texture);g=new e.PlaneBufferGeometry(window.innerWidth,window.innerHeight);this.quad=new e.Mesh(g,this.quadmaterial);this.transitionScene.add(this.quad);this.fromScene=a;this.toScene=b;g=function(){l.quadmaterial.uniforms.tDiffuse2.value=b.fbo.texture};a&&null!=a.panorama&&a.panorama.loaded?this.quadmaterial.uniforms.tDiffuse1.value=a.fbo.texture:a&&a.panorama.addEventListener("ready",function(){l.quadmaterial.uniforms.tDiffuse1.value=
a.fbo.texture});b&&null!=b.panorama&&b.panorama.loaded?this.quadmaterial.uniforms.tDiffuse2.value=b.fbo.texture:b&&b.panorama.addEventListener("ready",g);this.execute=function(){this.transitionParams.animateTransition=!0;"parallax"!=this.transitionParams.type||!this.isInitiatorInfospot||"slider_panorama"==this.toScene.panorama.subtype||this.fromScene&&"slider_panorama"==this.fromScene.panorama.subtype||this.parallax()};this.destroy=function(){this.toScene.destroy();this.fromScene.destroy()};this.parallax=
function(){var a=this.fromScene,d=this.toScene;if(a){var b=a.lastTouch,c=a.camera.position,g=new e.Vector3;g.subVectors(c,b).normalize();c=new e.Vector3;a.camera.getWorldDirection(c);(new e.Vector3).subVectors(c,b.clone().normalize());b=g.multiply(new e.Vector3(-1,0,1));new e.Vector3;c=d.control.getRotations().h-a.control.getRotations().h;g=g.clone().applyAxisAngle(new e.Vector3(0,1,0),c).normalize().clone();c=d.panorama.position.clone();a=(new TWEEN.Tween(a.panorama.position)).to({x:2E3*b.x,y:2E3*
b.y,z:2E3*b.z},1500).easing(TWEEN.Easing.Cubic.Out);d.panorama.position.set(-2E3*g.x,g.y,-2E3*g.z);d.panorama.position.needsUpdate=!0;d=(new TWEEN.Tween(d.panorama.position)).to({x:c.x,y:c.y,z:c.z},1500).easing(TWEEN.Easing.Cubic.Out);a.start();d.start()}};this.render=function(){if(null===this.fromScene){var a=d&&(d.controlEnabled||!1===d.controlEnabled)?d.controlEnabled:!0;this.toScene.render(!1);this.toScene&&this.toScene.control&&(this.toScene.control.enabled=a);this.transitionParams.animateTransition=
!1}else this.transitionParams.animateTransition&&(a=1+Math.sin(this.transitionParams.transitionSpeed*this.clock.getElapsedTime()/Math.PI),this.transition=e.Math.smoothstep(a,this.transitionParams.smoothstep.start,this.transitionParams.smoothstep.end)),this.quadmaterial.uniforms.mixRatio.value=this.transition,0==this.transition?(a=d&&(d.controlEnabled||!1===d.controlEnabled)?d.controlEnabled:!0,this.toScene.render(!1),this.toScene&&this.toScene.control&&(this.toScene.control.enabled=a),this.fromScene&&
this.fromScene.control&&(this.fromScene.control.enabled=!1),this.transitionParams.animateTransition=!1):1==this.transition?(a=d&&(d.controlEnabled||!1===d.controlEnabled)?d.controlEnabled:!0,this.fromScene.render(!1),this.toScene&&this.toScene.control&&(this.toScene.control.enabled=!1),this.fromScene&&this.fromScene.control&&(this.fromScene.control.enabled=a)):(a=d&&(d.controlEnabled||!1===d.controlEnabled)?d.controlEnabled:!0,this.fromScene.render(!0),this.toScene.render(!0),this.toScene&&this.toScene.control&&
(this.toScene.control.enabled=a),this.fromScene&&this.fromScene.control&&(this.fromScene.control.enabled=a),c.setRenderTarget(null),c.clear(),c.clearDepth(),c.render(this.transitionScene,this.cameraOrtho))}}function Z(a){var b="100%",c="100%";a&&a.container&&a.container.style&&(b=a.container.style.width||"100%",c=a.container.style.height||"100%");var d=a&&a.container?a.container:document.createElement("div");d.classList.add("panolens-container");d.style.width=b;d.style.height=c;d._width=window.innerWidth;
d._height=window.innerHeight;a&&a.container||document.body.appendChild(d);this.container=d;this.options=Object.assign({container:this.container,autoHideInfospot:!0,horizontalView:!1,clickTolerance:10,cameraFov:60,reverseDragging:!1,enableReticle:!1,dwellTime:1500,autoReticleSelect:!0,viewIndicator:!1,indicatorSize:30,output:null,autoRotate:!1,autoRotateSpeed:2,autoRotateActivationDuration:5E3,initialLookAt:new e.Vector3(0,0,-Number.MAX_SAFE_INTEGER),cameraInitialLookAt:null,momentum:!0,rotateSpeed:-1,
dampingFactor:.1,defaultFov:60,controlEnabled:!0},a);this.renderer=new e.WebGLRenderer({antialias:!1});this.renderer.setPixelRatio(window.devicePixelRatio);this.renderer.setSize(window.innerWidth,window.innerHeight);this.renderer.autoClear=!1;this.renderer.setClearColor(0,0);this.renderer.domElement.classList.add("panolens-canvas");this.renderer.domElement.style.display="block";this.container.style.backgroundColor="#000";this.container.appendChild(this.renderer.domElement);this.options.renderer=this.renderer;
this.options.container=this.container;this.controlIndex=this.mode=null;this.autoRotate=this.options.autoRotate;this.targetViewer=this.viewer=null;this.viewersQueue=[];this.composer=null;this.animate()}function aa(a){G.call(this,"image",a);this.scale.x*=-1;this.subtype=this.type="image_little_planet"}function ba(a,b){function c(){return 2*Math.PI/60/60*f.autoRotateSpeed}function d(a){if(!1!==f.enabled){a.preventDefault();if(a.button===f.mouseButtons.ORBIT){if(!0===f.noRotate)return;y=w.ROTATE;r.set(a.clientX,
a.clientY)}else if(a.button===f.mouseButtons.ZOOM){if(!0===f.noZoom)return;y=w.DOLLY;S.set(a.clientX,a.clientY)}else if(a.button===f.mouseButtons.PAN){if(!0===f.noPan)return;y=w.PAN;E.set(a.clientX,a.clientY)}y!==w.NONE&&(document.addEventListener("mousemove",g,!1),document.addEventListener("mouseup",l,!1),f.dispatchEvent(M))}}function g(a){if(!1!==f.enabled){a.preventDefault();var d=f.domElement===document?f.domElement.body:f.domElement;y===w.ROTATE?!0!==f.noRotate&&(L.set(a.clientX,a.clientY),n.subVectors(L,
r),0==r.x&&0==r.y?(r.set(L.x,L.y),n.subVectors(L,r)):(f.rotateLeft(2*Math.PI*n.x/d.clientHeight*f.rotateSpeed),f.rotateUp(2*Math.PI*n.y/d.clientHeight*f.rotateSpeed),r.copy(L))):y===w.DOLLY?!0!==f.noZoom&&(u.set(a.clientX,a.clientY),v.subVectors(u,S),0<v.y?f.dollyIn():0>v.y&&f.dollyOut(),S.copy(u)):y===w.PAN&&!0!==f.noPan&&(x.set(a.clientX,a.clientY),p.subVectors(x,E),f.pan(p.x,p.y),E.copy(x))}}function l(){!1!==f.enabled&&(document.removeEventListener("mousemove",g,!1),document.removeEventListener("mouseup",
l,!1),f.dispatchEvent(N),y=w.NONE)}function k(a){if(!1!==f.enabled&&!0!==f.noZoom&&y===w.NONE){a.preventDefault();a.stopPropagation();var d=0;void 0!==a.wheelDelta?d=a.wheelDelta:void 0!==a.detail&&(d=-a.detail);0<d?(f.object.fov=f.object.fov<f.maxFov?f.object.fov+1:f.maxFov,f.object.updateProjectionMatrix()):0>d&&(f.object.fov=f.object.fov>f.minFov?f.object.fov-1:f.minFov,f.object.updateProjectionMatrix());f.dispatchEvent(R);f.dispatchEvent(M);f.dispatchEvent(N);f.dispatchEvent(P)}}function q(a){}
function m(a){if(!1!==f.enabled&&!0!==f.noKeys&&!0!==f.noRotate&&!f.autoRotate){var d=f.momentum&&!f.autoRotate?f.momentumKeydownFactor*f.momentumFactor:f.momentumKeydownFactor;switch(a.keyCode){case f.keys.UP:f.rotateUp(f.rotateSpeed*d);break;case f.keys.BOTTOM:f.rotateUp(-f.rotateSpeed*d);break;case f.keys.LEFT:f.rotateLeft(f.rotateSpeed*d);break;case f.keys.RIGHT:f.rotateLeft(-f.rotateSpeed*d)}}}function Q(a){if(!1!==f.enabled){switch(a.touches.length){case 1:if(!0===f.noRotate)return;y=w.TOUCH_ROTATE;
r.set(a.touches[0].pageX,a.touches[0].pageY);break;case 2:if(!0===f.noZoom)return;y=w.TOUCH_DOLLY;var d=a.touches[0].pageX-a.touches[1].pageX;a=a.touches[0].pageY-a.touches[1].pageY;S.set(0,Math.sqrt(d*d+a*a));break;case 3:if(!0===f.noPan)return;y=w.TOUCH_PAN;E.set(a.touches[0].pageX,a.touches[0].pageY);break;default:y=w.NONE}y!==w.NONE&&f.dispatchEvent(M)}}function h(a){if(!1!==f.enabled){a.preventDefault();a.stopPropagation();var d=f.domElement===document?f.domElement.body:f.domElement;switch(a.touches.length){case 1:var b=
.38*f.rotateSpeed;if(!0===f.noRotate)break;if(y!==w.TOUCH_ROTATE)break;L.set(a.touches[0].pageX,a.touches[0].pageY);n.subVectors(L,r);f.rotateLeft(2*Math.PI*n.x/d.clientHeight*b);f.rotateUp(2*Math.PI*n.y/d.clientHeight*b);r.copy(L);break;case 2:if(!0===f.noZoom)break;if(y!==w.TOUCH_DOLLY)break;d=a.touches[0].pageX-a.touches[1].pageX;a=a.touches[0].pageY-a.touches[1].pageY;u.set(0,Math.sqrt(d*d+a*a));v.subVectors(u,S);0>v.y?(f.object.fov=f.object.fov<f.maxFov?f.object.fov+1:f.maxFov,f.object.updateProjectionMatrix()):
0<v.y&&(f.object.fov=f.object.fov>f.minFov?f.object.fov-1:f.minFov,f.object.updateProjectionMatrix());S.copy(u);f.dispatchEvent(R);f.dispatchEvent(P);break;case 3:if(!0===f.noPan)break;if(y!==w.TOUCH_PAN)break;x.set(a.touches[0].pageX,a.touches[0].pageY);p.subVectors(x,E);f.pan(p.x,p.y);E.copy(x);break;default:y=w.NONE}}}function J(){!1!==f.enabled&&(f.dispatchEvent(N),y=w.NONE)}this.object=a;this.domElement=void 0!==b?b:document;this.frameId=null;this.enabled=!0;this.center=this.target=new e.Vector3;
this.noZoom=!1;this.zoomSpeed=1;this.minDistance=0;this.maxDistance=Infinity;this.minZoom=0;this.maxZoom=Infinity;this.noRotate=!1;this.rotateSpeed=-.15;this.noPan=!0;this.keyPanSpeed=7;this.autoRotate=!1;this.autoRotateSpeed=2;this.minPolarAngle=0;this.maxPolarAngle=Math.PI;this.momentumKeydownFactor=.05;this.speedLimit=.04;this.publicSphericalDelta=new e.Spherical;this.momentum=!0;this.momentumFactor=7.5;this.enableDamping=!0;this.dampingFactor=.03;this.minFov=30;this.maxFov=120;this.minAzimuthAngle=
-Infinity;this.maxAzimuthAngle=Infinity;this.noKeys=!1;this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40};this.mouseButtons={ORBIT:e.MOUSE.LEFT,ZOOM:e.MOUSE.MIDDLE,PAN:e.MOUSE.RIGHT};var f=this,r=new e.Vector2,L=new e.Vector2,n=new e.Vector2,E=new e.Vector2,x=new e.Vector2,p=new e.Vector2,z=new e.Vector3,t=new e.Vector3,S=new e.Vector2,u=new e.Vector2,v=new e.Vector2,D=0,A=0,B=0,C=0,F=1,G=new e.Vector3,H=new e.Vector3,I=new e.Quaternion,w={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},
y=w.NONE;this.target0=this.target.clone();this.position0=this.object.position.clone();this.zoom0=this.object.zoom;var K=(new e.Quaternion).setFromUnitVectors(a.up,new e.Vector3(0,1,0)),O=K.clone().inverse(),R={type:"change"},M={type:"start"},N={type:"end"},P={type:"fov"};this.setLastQuaternion=function(a){I.copy(a);f.object.quaternion.copy(a)};this.getLastPosition=function(){return H};this.rotateLeft=function(a){void 0===a&&(a=c());a=this.momentum&&!this.autoRotate?a/=this.momentumFactor:a;C-=a};
this.rotateUp=function(a){void 0===a&&(a=c());a=this.momentum&&!this.autoRotate?a/=this.momentumFactor:a;B-=a};this.rotateLeftStatic=function(a){this.enableDamping=!1;C-=a;this.update();this.enableDamping=!0};this.rotateUpStatic=function(a){this.enableDamping=!1;B-=a;this.update();this.enableDamping=!0};this.centerTo=function(a,d){var b=f.enableDamping;f.enableDamping=!1;var g=this.object.position;t.copy(g).sub(this.target);t.applyQuaternion(K);D=Math.atan2(t.x,t.z);A=Math.atan2(Math.sqrt(t.x*t.x+
t.z*t.z),t.y);this.autoRotate&&y===w.NONE&&this.rotateLeft(c());D=a;A=d;f.publicSphericalDelta.data={theta:D};D=Math.max(this.minAzimuthAngle,Math.min(this.maxAzimuthAngle,D));A=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,A));A=Math.max(1E-7,Math.min(Math.PI-1E-7,A));a=t.length()*F;a=Math.max(this.minDistance,Math.min(this.maxDistance,a));this.target.add(G);t.x=a*Math.sin(A)*Math.sin(D);t.y=a*Math.cos(A);t.z=a*Math.sin(A)*Math.cos(D);t.applyQuaternion(O);g.copy(this.target).add(t);this.object.lookAt(this.target);
F=1;G.set(0,0,0);if(1E-7<H.distanceToSquared(this.object.position)||1E-7<8*(1-I.dot(this.object.quaternion)))this.dispatchEvent(R),H.copy(this.object.position),I.copy(this.object.quaternion);f.enableDamping=b};this.getRotations=function(){return{h:D,v:A}};this.panLeft=function(a){var d=this.object.matrix.elements;z.set(d[0],d[1],d[2]);z.multiplyScalar(-a);G.add(z)};this.panUp=function(a){var d=this.object.matrix.elements;z.set(d[4],d[5],d[6]);z.multiplyScalar(a);G.add(z)};this.pan=function(a,d){var b=
f.domElement===document?f.domElement.body:f.domElement;if(f.object instanceof e.PerspectiveCamera){var c=f.object.position.clone().sub(f.target).length();c*=Math.tan(f.object.fov/2*Math.PI/180);f.panLeft(2*a*c/b.clientHeight);f.panUp(2*d*c/b.clientHeight)}else f.object instanceof e.OrthographicCamera?(f.panLeft(a*(f.object.right-f.object.left)/b.clientWidth),f.panUp(d*(f.object.top-f.object.bottom)/b.clientHeight)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.")};
this.dollyIn=function(a){void 0===a&&(a=Math.pow(.95,f.zoomSpeed));f.object instanceof e.PerspectiveCamera?F/=a:f.object instanceof e.OrthographicCamera?(f.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom*a)),f.object.updateProjectionMatrix(),f.dispatchEvent(R)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.")};this.dollyOut=function(a){void 0===a&&(a=Math.pow(.95,f.zoomSpeed));f.object instanceof e.PerspectiveCamera?F*=a:
f.object instanceof e.OrthographicCamera?(f.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/a)),f.object.updateProjectionMatrix(),f.dispatchEvent(R)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.")};this.update=function(a){var d=this.object.position;t.copy(d).sub(this.target);t.applyQuaternion(K);D=Math.atan2(t.x,t.z);A=Math.atan2(Math.sqrt(t.x*t.x+t.z*t.z),t.y);this.autoRotate&&y===w.NONE&&this.rotateLeft(c());!0===this.enableDamping&&
(C=e.Math.clamp(C,-this.speedLimit,this.speedLimit),B=e.Math.clamp(B,-this.speedLimit,this.speedLimit));D+=C;A+=B;f.publicSphericalDelta.data={theta:D};D=Math.max(this.minAzimuthAngle,Math.min(this.maxAzimuthAngle,D));A=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,A));A=Math.max(1E-7,Math.min(Math.PI-1E-7,A));var b=t.length()*F;b=Math.max(this.minDistance,Math.min(this.maxDistance,b));this.target.add(G);t.x=b*Math.sin(A)*Math.sin(D);t.y=b*Math.cos(A);t.z=b*Math.sin(A)*Math.cos(D);t.applyQuaternion(O);
d.copy(this.target).add(t);this.object.lookAt(this.target);this.autoRotate||!0!==this.enableDamping||(!this.momentum||y!==w.ROTATE&&y!==w.TOUCH_ROTATE)&&y!==w.NONE?B=C=0:(C*=1-this.dampingFactor,B*=1-this.dampingFactor);F=1;G.set(0,0,0);if(1E-7<H.distanceToSquared(this.object.position)||1E-7<8*(1-I.dot(this.object.quaternion)))!0!==a&&this.dispatchEvent(R),H.copy(this.object.position),I.copy(this.object.quaternion)};this.reset=function(){y=w.NONE;this.target.copy(this.target0);this.object.position.copy(this.position0);
this.object.zoom=this.zoom0;this.object.updateProjectionMatrix();this.dispatchEvent(R);this.update()};this.getPolarAngle=function(){return A};this.getAzimuthalAngle=function(){return D};this.dispose=function(){this.domElement.removeEventListener("mousedown",d);this.domElement.removeEventListener("mousewheel",k);this.domElement.removeEventListener("DOMMouseScroll",k);this.domElement.removeEventListener("touchstart",Q);this.domElement.removeEventListener("touchend",J);this.domElement.removeEventListener("touchmove",
h);window.removeEventListener("keyup",q);window.removeEventListener("keydown",m)};this.domElement.addEventListener("mousedown",d,{passive:!1});this.domElement.addEventListener("mousewheel",k,{passive:!1});this.domElement.addEventListener("DOMMouseScroll",k,{passive:!1});this.domElement.addEventListener("touchstart",Q,{passive:!1});this.domElement.addEventListener("touchend",J,{passive:!1});this.domElement.addEventListener("touchmove",h,{passive:!1});window.addEventListener("keyup",q,{passive:!1});
window.addEventListener("keydown",m,{passive:!1});this.update()}function ca(a,b){var c=this,d=0,g=0,l=0,k=0;this.camera=a;this.camera.rotation.reorder("YXZ");this.domElement=void 0!==b?b:document;this.enabled=!0;this.deviceOrientation={alpha:null,beta:null,gamma:null};this.initialViewOffsetAngle=this.alphaOffsetAngle=this.alpha=this.screenOrientation=0;var q=function(a){null==c.deviceOrientation.alpha&&a&&a.alpha&&(c.initialViewOffsetAngle=e.Math.degToRad(a.alpha));c.enabled&&(c.deviceOrientation=
a)},m=function(){c.screenOrientation=window.orientation||0},Q=function(a){c.enabled&&(a.preventDefault(),a.stopPropagation(),l=a.touches[0].pageX,k=a.touches[0].pageY)},h=function(a){c.enabled&&(a.preventDefault(),a.stopPropagation(),d+=e.Math.degToRad((a.touches[0].pageX-l)/4),g+=e.Math.degToRad((k-a.touches[0].pageY)/4),c.updateAlphaOffsetAngle(d),l=a.touches[0].pageX,k=a.touches[0].pageY)};this.connect=function(){m();window.addEventListener("orientationchange",m,{passive:!0});window.addEventListener("deviceorientation",
q,{passive:!0});window.addEventListener("deviceorientation",this.update.bind(this),{passive:!0});c.domElement.addEventListener("touchstart",Q,{passive:!1});c.domElement.addEventListener("touchmove",h,{passive:!1});c.enabled=!0};this.disconnect=function(){window.removeEventListener("orientationchange",m,!1);window.removeEventListener("deviceorientation",q,!1);window.removeEventListener("deviceorientation",this.update.bind(this),!1);c.domElement.removeEventListener("touchstart",Q,!1);c.domElement.removeEventListener("touchmove",
h,!1);c.enabled=!1};this.update=function(a){if(!1!==c.enabled){a=null!=c.deviceOrientation.alpha?e.Math.degToRad(c.deviceOrientation.alpha)+c.alphaOffsetAngle-c.initialViewOffsetAngle:c.alphaOffsetAngle;var d=null!=c.deviceOrientation.beta?e.Math.degToRad(c.deviceOrientation.beta):1.6,b=null!=c.deviceOrientation.gamma?e.Math.degToRad(c.deviceOrientation.gamma):0,l=c.screenOrientation?e.Math.degToRad(c.screenOrientation):0,k=c.camera.quaternion,q=new e.Vector3(0,0,1),m=new e.Euler,Q=new e.Quaternion,
h=new e.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5)),t=new e.Quaternion,J=new e.Quaternion;if(0==c.screenOrientation){var n=new e.Vector3(1,0,0);t.setFromAxisAngle(n,-g)}else 180==c.screenOrientation?(n=new e.Vector3(1,0,0),t.setFromAxisAngle(n,g)):90==c.screenOrientation?(n=new e.Vector3(0,1,0),t.setFromAxisAngle(n,g)):-90==c.screenOrientation&&(n=new e.Vector3(0,1,0),t.setFromAxisAngle(n,-g));h.multiply(t);h.multiply(J);m.set(d,a,-b,"YXZ");k.setFromEuler(m);k.multiply(h);k.multiply(Q.setFromAxisAngle(q,
-l));c.alpha=a}};this.updateAlphaOffsetAngle=function(a){this.alphaOffsetAngle=a;0==d&&(d=a);this.update()};this.getRotations=function(){return{h:c.alpha,v:0}};this.dispose=function(){this.disconnect()};this.connect()}function T(a,b,c){function d(){c.addEventListener("mousemove",l,!1);c.addEventListener("mousedown",k,!1);c.addEventListener("mouseup",q,!1);c.addEventListener("mouseleave",q,!1);c.addEventListener("touchmove",m,!1);c.addEventListener("touchstart",h,!1);c.addEventListener("touchend",
n,!1)}function g(){c.removeEventListener("mousemove",l,!1);c.removeEventListener("mousedown",k,!1);c.removeEventListener("mouseup",q,!1);c.removeEventListener("mouseleave",q,!1);c.removeEventListener("touchmove",m,!1);c.removeEventListener("touchstart",h,!1);c.removeEventListener("touchend",n,!1)}function l(d){d.preventDefault();var g=c.getBoundingClientRect();p.x=(d.clientX-g.left)/g.width*2-1;p.y=2*-((d.clientY-g.top)/g.height)+1;r.setFromCamera(p,b);x&&z.enabled?(r.ray.intersectPlane(f,E)&&x.position.copy(E.sub(u)),
z.dispatchEvent({type:"drag",object:x})):(r.setFromCamera(p,b),d=r.intersectObjects(a),0<d.length?(d=d[0].object,f.setFromNormalAndCoplanarPoint(b.getWorldDirection(f.normal),d.position),v!==d&&(z.dispatchEvent({type:"hoveron",object:d}),c.style.cursor="pointer",v=d)):null!==v&&(z.dispatchEvent({type:"hoveroff",object:v}),c.style.cursor="auto",v=null))}function k(d){d.preventDefault();r.setFromCamera(p,b);d=r.intersectObjects(a);0<d.length&&(x=d[0].object,r.ray.intersectPlane(f,E)&&u.copy(E).sub(x.position),
c.style.cursor="move",z.dispatchEvent({type:"dragstart",object:x}))}function q(a){a.preventDefault();x&&(z.dispatchEvent({type:"dragend",object:x}),x=null);c.style.cursor="auto"}function m(a){a.preventDefault();a=a.changedTouches[0];var d=c.getBoundingClientRect();p.x=(a.clientX-d.left)/d.width*2-1;p.y=2*-((a.clientY-d.top)/d.height)+1;r.setFromCamera(p,b);x&&z.enabled&&(r.ray.intersectPlane(f,E)&&x.position.copy(E.sub(u)),z.dispatchEvent({type:"drag",object:x}))}function h(d){d.preventDefault();
d=d.changedTouches[0];var g=c.getBoundingClientRect();p.x=(d.clientX-g.left)/g.width*2-1;p.y=2*-((d.clientY-g.top)/g.height)+1;r.setFromCamera(p,b);d=r.intersectObjects(a);0<d.length&&(x=d[0].object,f.setFromNormalAndCoplanarPoint(b.getWorldDirection(f.normal),x.position),r.ray.intersectPlane(f,E)&&u.copy(E).sub(x.position),c.style.cursor="move",z.dispatchEvent({type:"dragstart",object:x}))}function n(a){a.preventDefault();x&&(z.dispatchEvent({type:"dragend",object:x}),x=null);c.style.cursor="auto"}
if(a.isCamera){console.warn("THREE.DragControls: Constructor now expects ( objects, camera, domElement )");var J=a;a=b;b=J}var f=new e.Plane,r=new e.Raycaster,p=new e.Vector2,u=new e.Vector3,E=new e.Vector3,x=null,v=null,z=this;d();this.enabled=!0;this.activate=d;this.deactivate=g;this.dispose=function(){g()};this.setObjects=function(){console.error("THREE.DragControls: setObjects() has been removed.")};this.on=function(a,d){console.warn("THREE.DragControls: on() has been deprecated. Use addEventListener() instead.");
z.addEventListener(a,d)};this.off=function(a,d){console.warn("THREE.DragControls: off() has been deprecated. Use removeEventListener() instead.");z.removeEventListener(a,d)};this.notify=function(a){console.error("THREE.DragControls: notify() has been deprecated. Use dispatchEvent() instead.");z.dispatchEvent({type:a})}}function U(a){this.format=null;this.eyeSep=void 0===a?.064:a;this.loffset=new e.Vector2;this.roffset=new e.Vector2}function da(a,b){b=void 0===b?new U:b;v.call(this,a);this.stereo=
b;this.type="stereo_image_panorama"}function I(a,b){b=void 0===b?{}:b;var c=new e.SphereBufferGeometry(5E3+ea,60,40),d=new e.MeshBasicMaterial({opacity:0,transparent:!0});n.call(this,c,d);this.src=a;this.options={videoElement:document.createElement("video"),loop:!0,muted:!0,autoplay:!1,playsinline:!0,crossOrigin:"anonymous"};Object.assign(this.options,b);this.videoElement=this.options.videoElement;this.videoProgress=0;this.radius=5E3+ea;ea-=10;this.addEventListener("leave",this.pauseVideo.bind(this));
this.addEventListener("enter-fade-start",this.resumeVideoProgress.bind(this));this.addEventListener("video-toggle",this.toggleVideo.bind(this));this.addEventListener("video-time",this.setVideoCurrentTime.bind(this))}function fa(a,b,c){b=void 0===b?{}:b;c=void 0===c?new U:c;I.call(this,a,b);this.stereo=c;this.type="stereo_video_panorama"}function na(a){var b=new e.OrthographicCamera(-1,1,1,-1,0,1),c=new e.Scene,d=new e.StereoCamera;d.aspect=.5;var g=new e.WebGLRenderTarget(512,512,{minFilter:e.LinearFilter,
magFilter:e.NearestFilter,format:e.RGBAFormat});g.scissorTest=!0;g.texture.generateMipmaps=!1;var l=new e.Vector2(.441,.156),k=(new e.PlaneBufferGeometry(1,1,10,20)).removeAttribute("normal").toNonIndexed(),q=k.attributes.position.array,m=k.attributes.uv.array;k.attributes.position.count*=2;k.attributes.uv.count*=2;var h=new Float32Array(2*q.length);h.set(q);h.set(q,q.length);var n=new Float32Array(2*m.length);n.set(m);n.set(m,m.length);m=new e.Vector2;q=q.length/3;for(var p=0,f=h.length/3;p<f;p++){m.x=
h[3*p];m.y=h[3*p+1];var r=m.dot(m);r=1.5+(l.x+l.y*r)*r;var u=p<q?0:1;h[3*p]=m.x/r*1.5-.5+u;h[3*p+1]=m.y/r*3;n[2*p]=.5*(n[2*p]+u)}k.attributes.position.array=h;k.attributes.uv.array=n;l=new e.MeshBasicMaterial({map:g.texture});k=new e.Mesh(k,l);c.add(k);this.setEyeSeparation=function(a){d.eyeSep=a};this.setSize=function(d,b){a.setSize(d,b);var c=a.getPixelRatio();g.setSize(d*c,b*c)};this.render=function(e,l,f){var k=f instanceof da||f instanceof fa;e.updateMatrixWorld();k&&this.setEyeSeparation(f.stereo.eyeSep);
null===l.parent&&l.updateMatrixWorld();d.update(l);l=g.width/2;var q=g.height;a.autoClear&&a.clear();k&&f.updateTextureToLeft();g.scissor.set(0,0,l,q);g.viewport.set(0,0,l,q);a.setRenderTarget(g);a.render(e,d.cameraL);a.clearDepth();k&&f.updateTextureToRight();g.scissor.set(l,0,l,q);g.viewport.set(l,0,l,q);a.setRenderTarget(g);a.render(e,d.cameraR);a.clearDepth();a.setRenderTarget(null);a.render(c,b)}}function ha(a){a=void 0===a?{}:a;this.options=Object.assign({container:this.setupContainer(a.container),
autoHideInfospot:!0,horizontalView:!1,clickTolerance:10,cameraFov:60,reverseDragging:!1,enableReticle:!1,dwellTime:1500,autoReticleSelect:!0,viewIndicator:!1,indicatorSize:30,output:null,autoRotate:!1,autoRotateSpeed:2,autoRotateActivationDuration:5E3,initialLookAt:new e.Vector3(0,0,-Number.MAX_SAFE_INTEGER),cameraInitialLookAt:null,momentum:!0,rotateSpeed:-1,dampingFactor:.1,defaultFov:60},a);this.viewerInstanceNumber=Math.floor(30*Math.random());var b=this.options;a=b.container;var c=b.cameraFov,
d=b.defaultFov,g=b.viewIndicator,l=b.indicatorSize,k=b.enableReticle,q=b.reverseDragging,m=b.output,p=b.scene,n=b.camera;b=b.renderer;var J=a.clientWidth,f=a.clientHeight,r={minFilter:e.LinearFilter,magFilter:e.LinearFilter};this.fbo=new e.WebGLRenderTarget(J,f,r);this.reticleFbo=new e.WebGLRenderTarget(J,f,r);this.container=a;this.scene=this.setupScene(p);this.sceneReticle=new e.Scene;this.defaultFov=d;this.camera=this.setupCamera(c,J/f,n);this.renderer=this.setupRenderer(b,a);this.reticle=this.addReticle(this.camera,
this.sceneReticle);this.control=this.setupControls(this.camera,a);this.effect=this.setupEffects(this.renderer,a);this.lastTouch={x:0,y:0,z:0};this.mode=u.NORMAL;this.pressObject=this.pressEntityObject=this.infospot=this.hoverObject=this.panorama=null;this.raycaster=new e.Raycaster;this.raycasterPoint=new e.Vector2;this.userMouse=new e.Vector2;this.updateCallbacks=[];this.requestAnimationId=null;this.cameraFrustum=new e.Frustum;this.cameraViewProjectionMatrix=new e.Matrix4;this.outputDivElement=this.autoRotateRequestId=
null;this.touchSupported="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch;this.tweenLeftAnimation=new h.Tween;this.tweenUpAnimation=new h.Tween;this.tweenCanvasOpacityOut=new h.Tween;this.tweenCanvasOpacityIn=new h.Tween;this.outputEnabled=!1;this.viewIndicatorSize=l;this.tempEnableReticle=k;this.setupTween();this.handlerMouseUp=this.onMouseUp.bind(this);this.handlerMouseDown=this.onMouseDown.bind(this);this.handlerMouseMove=this.onMouseMove.bind(this);this.handlerWindowResize=
this.onWindowResize.bind(this);this.handlerKeyDown=this.onKeyDown.bind(this);this.handlerKeyUp=this.onKeyUp.bind(this);this.handlerTap=this.onTap.bind(this,{clientX:J/2,clientY:f/2});g&&this.addViewIndicator();q&&this.reverseDraggingDirection();k?this.enableReticleControl():this.registerMouseAndTouchEvents();"overlay"===m&&this.addOutputElement();this.registerEventListeners();ka?window.setInterval(this.animate.bind(this),1E3/60):this.animate.call(this)}var oa="^0.105.2".replace(/[^0-9.]/g,""),C={ORBIT:0,
DEVICEORIENTATION:1,OBJECT:2,DRAG:3},u={UNKNOWN:0,NORMAL:1,CARDBOARD:2,STEREO:3},H={TAB:0,SBS:1},F={Info:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAABIAAAASABGyWs+AAAACXZwQWcAAABAAAAAQADq8/hgAAADBklEQVR42u2bP08UQRiHnzFaSYCI/xoksdBIqGwIiYWRUBISExpCQ0ej38FWOmlIKKhoMPEbaCxsrrHiYrQgOSlQEaICrT+LHSPZzNzt3s3c3Hn7lHvLzvv82L2dm30XKioqKgYY062BJF0HpoA7wARwBbhsPz4DjoEG8AnYNcZ8Sx1Op8IXJM1KWpdUV3nq9m9nJV1I7VNGfEzSM0mNNqR9NOwxx1L7NRMflbQm6SSgeJ4TO8Zoat+8/LKkg4jieQ4kLaf2RtKwpJ0uiufZkTScSn5S0l5C+b/sSZrstvyMpKPU5uc4kjTTjkvpeYCkaeA1/+7hvcIZMGuMqUULQNIU8Aa4ltrWwyHwyBizGzwASSPAe+B2assW7AH3jTE/i+xcZoa12Qfy2Bo3i+5cKABl99zF1GYlWFTBeULLS0DZrOsDcDNggTXgc27bLWA64BhfgHvGmB8dHUXZ1DM0S45xliKMs9bKr+klIOkqsBrwv9JtVq1DewEAT4Ch1BYdMGQdygeg7Df4SmqDAKyoyXpCszPgITCeuvoAjFuX0gE8jljUdv7bCtiOOJ7XpdUZ8L/gdXHOA5QtYH5NXXVgbrgWWn1nwFTqaiPgdPIFcDd1tRFwOl307DwRuZgXwLvctgfA04hjOp18AcReZ6sZY16e3yDpUuQxnU6+S2AkcjEpcDr1zxOXSPgCKLSa0mc4nXwB/EpdbQScTr4AGqmrjYDTyRfAx9TVRsDp5Aug8LJyH+F0cgZg58z11BUHpO5ruGh2G3ybuuqAeF2aBfAqddUB8bq0OgP2U1cegH3aOQOMMb+BrdTVB2DLupQLwLIOnKY26IBT6+ClaQDGmO/ARmqLDtiwDn7HVkcY+EdjNoTlCI+tYhO2iUppm6HKslPUq2qQKHpUe8AFsjaUXuUQWCgqXyoAG8IuME/WkNRrnAHzZfqDSgdgQ6gBc2Td3b3CMTBXtkOsIzTIjZLnQhjcVtlcEIPZLJ0LoVvt8s/Va+3yuSAG84UJRxB98cpM9dJURUVFxSDzBxKde4Lk3/h2AAAAAElFTkSuQmCC",
Check:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCI+PHBhdGggZD0iTTIxLDdMOSwxOUwzLjUsMTMuNUw0LjkxLDEyLjA5TDksMTYuMTdMMTkuNTksNS41OUwyMSw3WiIgLz48L3N2Zz4=",
WhiteTile:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIABAMAAAAGVsnJAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAB1WlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS40LjAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp0aWZmPSJodHRwOi8vbnMuYWRvYmUuY29tL3RpZmYvMS4wLyI+CiAgICAgICAgIDx0aWZmOkNvbXByZXNzaW9uPjE8L3RpZmY6Q29tcHJlc3Npb24+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgICAgIDx0aWZmOlBob3RvbWV0cmljSW50ZXJwcmV0YXRpb24+MjwvdGlmZjpQaG90b21ldHJpY0ludGVycHJldGF0aW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KAtiABQAAACRQTFRFAAAAAAAABgYGBwcHHh4eKysrx8fHy8vLzMzM7OzsAAAABgYG+q7SZgAAAAp0Uk5TAP7+/v7+/v7+/iJx/a8AAAOwSURBVHja7d0hbsNAEAVQo6SFI6XEcALDcgNLvUBvEBQVhpkWVYWlhSsVFS7t5QIshRt695lEASZP+8c7a1kzDL1fz+/zyuvzp6FbvoddrL6uDd1yGZ5eXldeb18N3fIx7A+58prmhm65DfvDcd0952lu6JabFbD/zVprZj1lzcys+fj9z8xTZtbT8rv8yWlu6BYAIgAAAAAAAAAAAABAM6QXEAEAAAAAAAAAgJ2gnaAIiIA3Q2qAGgAAAAAAAAAAAAAAAAAAAAAAAAAAQJsADkVFAAAAAAA8Bj0GRUAEREAEREAEREAEREAEAAAAAAAAAAB2gnaCIiACPplRA9QANUAERAAAAEVQERQBERCBVlfAcZ3aeZobusUKMGBhV6KUElHGKBERJR6/fxExRkQZl9/lT8S1oVsuhqyYMmPKjCkzvfcCpsxohrwY0Q06EAEAAAAAAAAAAACgGdILiAAAAAAAAAAAwE7QTlAERMCbITVADQAAAAAAAAAAAAAAAAAAAAAAAAAAwKmwQ1ERAAAAAACPQY9BERABERABERABERABERABAAAAAAAAAICdoJ2gCIiAT2bUADVADRABEQAAQBFUBEVABERgEyvAlJm+V4ApM6bMmDJjyowpM6bMdN0LmDKjGfJiRDfoQAQAAAAAAAAAAACAZkgvIAIAAAAAAAAAADtBO0EREAFvhtQANQAAAAAAAAAAAAAAAAAAAAAAAAAAAKfCDkVFAAAAAAA8Bj0GRUAEREAEREAEREAEREAEAAAAAAAAAAB2gnaCIiACPplRA9QANUAERAAAAEVQERQBERCBTawAU2b6XgGmzJgyY8qMKTOmzJgy03UvYMqMZsiLEd2gAxEAAAAAAAAAAAAAmiG9gAgAAAAAAAAAAOwE7QRFQAS8GVID1AAAAAAAAAAAAAAAAAAAAAAAAAAAAJwKOxQVAQAAAADwGPQYFAEREAEREAEREAEREAERAAAAAAAAAADYCdoJioAI+GRGDVAD1AAREAEAABRBRVAEREAENrECTJnpewWYMmPKjCkzpsyYMmPKTNe9gCkzmiEvRnSDDkQAAAAAAAAAAAAAaIb0AiIAAAAAAAAAALATtBMUARHwZkgNUAMAAAAAAAAAAAAAAAAAAAAAAAAAAHAq7FBUBAAAAADAY9BjUAREQAREQAREQAREQAREAAAAAAAAAABgJ2gnKAIi4JMZNUANUANEQAQAAFAEFUEREAER2MQKMGWm7xVgyowpM50PWen9ugNGXz1XaocAFgAAAABJRU5ErkJggg==",
ViewIndicator:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPCFET0NUWVBFIHN2ZyBQVUJMSUMgIi0vL1czQy8vRFREIFNWRyAxLjEvL0VOIiAiaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkIj4KPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBpZD0idmlldy1pbmRpY2F0b3IiIGhlaWdodD0iMzAiIHdpZHRoPSIzMCIgdmlld0JveD0iLTIuNSAtMSAzMCAzMCI+Cgk8c3R5bGUgdHlwZT0idGV4dC9jc3MiPi5zdDB7c3Ryb2tlLXdpZHRoOjI7c3Ryb2tlLW1pdGVybGltaXQ6MTA7ZmlsbDpub25lO30uc3Qxe3N0cm9rZS13aWR0aDo2O3N0cm9rZS1taXRlcmxpbWl0OjEwO30KCTwvc3R5bGU+Cgk8Zz4KCQk8cGF0aCBjbGFzcz0ic3QwIiBkPSJNIDEyLjUgMCBBIDEyLjUgMTIuNSAwIDAgMCAtMTIuNSAwIEEgMTIuNSAxMi41IDAgMCAwIDEyLjUgMCIgdHJhbnNmb3JtPSJtYXRyaXgoMSwwLDAsMSwxMywxNS41KSI+PC9wYXRoPgoJCTxwYXRoIGNsYXNzPSJzdDIiIGQ9Ik0gMTMgMCBMIDEwIDIgTCAxNiAyIFoiPjwvcGF0aD4KCQk8cGF0aCBjbGFzcz0ic3QyIiBkPSJNIDIgMCBBIDIgMiAwIDAgMCAtMiAwIEEgMiAyIDAgMCAwIDIgMCIgdHJhbnNmb3JtPSJtYXRyaXgoMSwwLDAsMSwxMywxNS41KSI+PC9wYXRoPgoJCTxwYXRoIGNsYXNzPSJzdDEiIGlkPSJpbmRpY2F0b3IiIHRyYW5zZm9ybT0ibWF0cml4KDEsMCwwLDEsMTMsMTUuNSkiPjwvcGF0aD4KCTwvZz4KPC9zdmc+"},
ia={load:function(a,b,c,d){b=void 0===b?function(){}:b;c=void 0===c?function(){}:c;d=void 0===d?function(){}:d;e.Cache.enabled=!0;var g,l,k;for(n in F)F.hasOwnProperty(n)&&a===F[n]&&(k=n);var q=e.Cache.get(k?k:a);if(void 0!==q)return b&&setTimeout(function(){c({loaded:1,total:1});b(q)},0),q;var m=window.URL||window.webkitURL;var h=document.createElementNS("http://www.w3.org/1999/xhtml","img");var p=function(){m.revokeObjectURL(h.src);void 0==q&&e.Cache.add(k?k:a,h);b(h)};if(0===a.indexOf("data:"))return h.addEventListener("load",
p,!1),h.src=a,h;h.crossOrigin=void 0!==this.crossOrigin?this.crossOrigin:"";var n=new window.XMLHttpRequest;n.open("GET",a,!0);n.responseType="arraybuffer";n.addEventListener("error",d);n.addEventListener("progress",function(a){if(a){var d=a.loaded,b=a.total;a.lengthComputable&&c({loaded:d,total:b})}});n.addEventListener("loadend",function(a){a&&(g=new Uint8Array(a.currentTarget.response),l=new window.Blob([g]),h.addEventListener("load",p,!1),h.src=m.createObjectURL(l))});n.send(null)}},M={load:function(a,
b,c,d){b=void 0===b?function(){}:b;var g=new e.Texture;ia.load(a,function(d){g.image=d;d=0<a.search(/\.(jpg|jpeg)$/)||0===a.search(/^data:image\/jpeg/);g.format=d?e.RGBFormat:e.RGBAFormat;g.needsUpdate=!0;b(g)},c,d);return g}},la={load:function(a,b,c,d){b=void 0===b?function(){}:b;c=void 0===c?function(){}:c;var g;var l=new e.CubeTexture([]);var k=0;var q={};var m={};a.map(function(a,e){ia.load(a,function(a){l.images[e]=a;k++;6===k&&(l.needsUpdate=!0,b(l))},function(a){q[e]={loaded:a.loaded,total:a.total};
m.loaded=0;g=m.total=0;for(var d in q)g++,m.loaded+=q[d].loaded,m.total+=q[d].total;6>g&&(m.total=m.total/g*6);c(m)},d)});return l}};O.prototype=Object.assign(Object.create(e.Sprite.prototype),{constructor:O,setColor:function(a){this.material.color.copy(a instanceof e.Color?a:new e.Color(a))},createCanvasTexture:function(a){a=new e.CanvasTexture(a);a.minFilter=e.LinearFilter;a.magFilter=e.LinearFilter;a.generateMipmaps=!1;return a},createCanvas:function(){var a=document.createElement("canvas"),b=
a.getContext("2d"),c=this.dpr;a.width=32*c;a.height=32*c;b.scale(c,c);b.shadowBlur=5;b.shadowColor="rgba(200,200,200,0.9)";return{canvas:a,context:b}},updateCanvasArcByProgress:function(a){var b=this.context,c=this.canvasWidth,d=this.canvasHeight,g=this.material,e=this.dpr,k=a*Math.PI*2,q=this.color.getStyle(),m=.5*c/e;e=.5*d/e;b.clearRect(0,0,c,d);b.beginPath();0===a?(b.arc(m,e,c/16,0,2*Math.PI),b.fillStyle=q,b.fill()):(b.arc(m,e,c/4-3,-Math.PI/2,-Math.PI/2+k),b.strokeStyle=q,b.lineWidth=3,b.stroke());
b.closePath();g.map.needsUpdate=!0},ripple:function(){var a=this,b=this.context,c=this.canvasWidth,d=this.canvasHeight,g=this.material,e=this.rippleDuration,k=performance.now(),q=this.color,m=this.dpr,h=.5*c/m,n=.5*d/m,p=function(){var l=window.requestAnimationFrame(p),r=(performance.now()-k)/e,u=0<1-r?1-r:0,v=r*c*.5/m;b.clearRect(0,0,c,d);b.beginPath();b.arc(h,n,v,0,2*Math.PI);b.fillStyle="rgba("+255*q.r+", "+255*q.g+", "+255*q.b+", "+u+")";b.fill();b.closePath();1<=r&&(window.cancelAnimationFrame(l),
a.updateCanvasArcByProgress(0),a.dispatchEvent({type:"reticle-ripple-end"}));g.map.needsUpdate=!0};this.dispatchEvent({type:"reticle-ripple-start"});p()},show:function(){this.visible=!0},hide:function(){this.visible=!1},start:function(a){this.autoSelect&&(this.dispatchEvent({type:"reticle-start"}),this.startTimestamp=performance.now(),this.callback=a,this.update())},end:function(){this.startTimestamp&&(window.cancelAnimationFrame(this.timerId),this.updateCanvasArcByProgress(0),this.startTimestamp=
this.timerId=this.callback=null,this.dispatchEvent({type:"reticle-end"}))},update:function(){this.timerId=window.requestAnimationFrame(this.update.bind(this));var a=(performance.now()-this.startTimestamp)/this.dwellTime;this.updateCanvasArcByProgress(a);this.dispatchEvent({type:"reticle-update",progress:a});1<=a&&(window.cancelAnimationFrame(this.timerId),this.callback&&this.callback(),this.end(),this.ripple())}});var h=function(a,b){return b={exports:{}},a(b,b.exports),b.exports}(function(a,b){b=
function(){this._tweens={};this._tweensAddedDuringUpdate={}};b.prototype={getAll:function(){return Object.keys(this._tweens).map(function(a){return this._tweens[a]}.bind(this))},removeAll:function(){this._tweens={}},add:function(a){this._tweens[a.getId()]=a;this._tweensAddedDuringUpdate[a.getId()]=a},remove:function(a){delete this._tweens[a.getId()];delete this._tweensAddedDuringUpdate[a.getId()]},update:function(a,b){var d=Object.keys(this._tweens);if(0===d.length)return!1;for(a=void 0!==a?a:c.now();0<
d.length;){this._tweensAddedDuringUpdate={};for(var g=0;g<d.length;g++){var e=this._tweens[d[g]];e&&!1===e.update(a)&&(e._isPlaying=!1,b||delete this._tweens[d[g]])}d=Object.keys(this._tweensAddedDuringUpdate)}return!0}};var c=new b;c.Group=b;c._nextId=0;c.nextId=function(){return c._nextId++};c.now="undefined"===typeof self&&"undefined"!==typeof process&&process.hrtime?function(){var a=process.hrtime();return 1E3*a[0]+a[1]/1E6}:"undefined"!==typeof self&&void 0!==self.performance&&void 0!==self.performance.now?
self.performance.now.bind(self.performance):void 0!==Date.now?Date.now:function(){return(new Date).getTime()};c.Tween=function(a,b){this._object=a;this._valuesStart={};this._valuesEnd={};this._valuesStartRepeat={};this._duration=1E3;this._repeat=0;this._repeatDelayTime=void 0;this._reversed=this._isPlaying=this._yoyo=!1;this._delayTime=0;this._startTime=null;this._easingFunction=c.Easing.Linear.None;this._interpolationFunction=c.Interpolation.Linear;this._chainedTweens=[];this._onStartCallback=null;
this._onStartCallbackFired=!1;this._onStopCallback=this._onCompleteCallback=this._onRepeatCallback=this._onUpdateCallback=null;this._group=b||c;this._id=c.nextId()};c.Tween.prototype={getId:function(){return this._id},isPlaying:function(){return this._isPlaying},to:function(a,b){this._valuesEnd=Object.create(a);void 0!==b&&(this._duration=b);return this},duration:function(a){this._duration=a;return this},start:function(a){this._group.add(this);this._isPlaying=!0;this._onStartCallbackFired=!1;this._startTime=
void 0!==a?"string"===typeof a?c.now()+parseFloat(a):a:c.now();this._startTime+=this._delayTime;for(var d in this._valuesEnd){if(this._valuesEnd[d]instanceof Array){if(0===this._valuesEnd[d].length)continue;this._valuesEnd[d]=[this._object[d]].concat(this._valuesEnd[d])}void 0!==this._object[d]&&(this._valuesStart[d]=this._object[d],!1===this._valuesStart[d]instanceof Array&&(this._valuesStart[d]*=1),this._valuesStartRepeat[d]=this._valuesStart[d]||0)}return this},stop:function(){if(!this._isPlaying)return this;
this._group.remove(this);this._isPlaying=!1;null!==this._onStopCallback&&this._onStopCallback(this._object);this.stopChainedTweens();return this},end:function(){this.update(Infinity);return this},stopChainedTweens:function(){for(var a=0,b=this._chainedTweens.length;a<b;a++)this._chainedTweens[a].stop()},group:function(a){this._group=a;return this},delay:function(a){this._delayTime=a;return this},repeat:function(a){this._repeat=a;return this},repeatDelay:function(a){this._repeatDelayTime=a;return this},
yoyo:function(a){this._yoyo=a;return this},easing:function(a){this._easingFunction=a;return this},interpolation:function(a){this._interpolationFunction=a;return this},chain:function(){this._chainedTweens=arguments;return this},onStart:function(a){this._onStartCallback=a;return this},onUpdate:function(a){this._onUpdateCallback=a;return this},onRepeat:function(a){this._onRepeatCallback=a;return this},onComplete:function(a){this._onCompleteCallback=a;return this},onStop:function(a){this._onStopCallback=
a;return this},update:function(a){var d;if(a<this._startTime)return!0;!1===this._onStartCallbackFired&&(null!==this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0);var b=(a-this._startTime)/this._duration;b=0===this._duration||1<b?1:b;var c=this._easingFunction(b);for(d in this._valuesEnd)if(void 0!==this._valuesStart[d]){var e=this._valuesStart[d]||0,m=this._valuesEnd[d];m instanceof Array?this._object[d]=this._interpolationFunction(m,c):("string"===typeof m&&
(m="+"===m.charAt(0)||"-"===m.charAt(0)?e+parseFloat(m):parseFloat(m)),"number"===typeof m&&(this._object[d]=e+(m-e)*c))}null!==this._onUpdateCallback&&this._onUpdateCallback(this._object,b);if(1===b)if(0<this._repeat){isFinite(this._repeat)&&this._repeat--;for(d in this._valuesStartRepeat)"string"===typeof this._valuesEnd[d]&&(this._valuesStartRepeat[d]+=parseFloat(this._valuesEnd[d])),this._yoyo&&(b=this._valuesStartRepeat[d],this._valuesStartRepeat[d]=this._valuesEnd[d],this._valuesEnd[d]=b),this._valuesStart[d]=
this._valuesStartRepeat[d];this._yoyo&&(this._reversed=!this._reversed);this._startTime=void 0!==this._repeatDelayTime?a+this._repeatDelayTime:a+this._delayTime;null!==this._onRepeatCallback&&this._onRepeatCallback(this._object)}else{null!==this._onCompleteCallback&&this._onCompleteCallback(this._object);a=0;for(d=this._chainedTweens.length;a<d;a++)this._chainedTweens[a].start(this._startTime+this._duration);return!1}return!0}};c.Easing={Linear:{None:function(a){return a}},Quadratic:{In:function(a){return a*
a},Out:function(a){return a*(2-a)},InOut:function(a){return 1>(a*=2)?.5*a*a:-.5*(--a*(a-2)-1)}},Cubic:{In:function(a){return a*a*a},Out:function(a){return--a*a*a+1},InOut:function(a){return 1>(a*=2)?.5*a*a*a:.5*((a-=2)*a*a+2)}},Quartic:{In:function(a){return a*a*a*a},Out:function(a){return 1- --a*a*a*a},InOut:function(a){return 1>(a*=2)?.5*a*a*a*a:-.5*((a-=2)*a*a*a-2)}},Quintic:{In:function(a){return a*a*a*a*a},Out:function(a){return--a*a*a*a*a+1},InOut:function(a){return 1>(a*=2)?.5*a*a*a*a*a:.5*
((a-=2)*a*a*a*a+2)}},Sinusoidal:{In:function(a){return 1-Math.cos(a*Math.PI/2)},Out:function(a){return Math.sin(a*Math.PI/2)},InOut:function(a){return.5*(1-Math.cos(Math.PI*a))}},Exponential:{In:function(a){return 0===a?0:Math.pow(1024,a-1)},Out:function(a){return 1===a?1:1-Math.pow(2,-10*a)},InOut:function(a){return 0===a?0:1===a?1:1>(a*=2)?.5*Math.pow(1024,a-1):.5*(-Math.pow(2,-10*(a-1))+2)}},Circular:{In:function(a){return 1-Math.sqrt(1-a*a)},Out:function(a){return Math.sqrt(1- --a*a)},InOut:function(a){return 1>
(a*=2)?-.5*(Math.sqrt(1-a*a)-1):.5*(Math.sqrt(1-(a-=2)*a)+1)}},Elastic:{In:function(a){return 0===a?0:1===a?1:-Math.pow(2,10*(a-1))*Math.sin(5*(a-1.1)*Math.PI)},Out:function(a){return 0===a?0:1===a?1:Math.pow(2,-10*a)*Math.sin(5*(a-.1)*Math.PI)+1},InOut:function(a){if(0===a)return 0;if(1===a)return 1;a*=2;return 1>a?-.5*Math.pow(2,10*(a-1))*Math.sin(5*(a-1.1)*Math.PI):.5*Math.pow(2,-10*(a-1))*Math.sin(5*(a-1.1)*Math.PI)+1}},Back:{In:function(a){return a*a*(2.70158*a-1.70158)},Out:function(a){return--a*
a*(2.70158*a+1.70158)+1},InOut:function(a){return 1>(a*=2)?.5*a*a*(3.5949095*a-2.5949095):.5*((a-=2)*a*(3.5949095*a+2.5949095)+2)}},Bounce:{In:function(a){return 1-c.Easing.Bounce.Out(1-a)},Out:function(a){return a<1/2.75?7.5625*a*a:a<2/2.75?7.5625*(a-=1.5/2.75)*a+.75:a<2.5/2.75?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375},InOut:function(a){return.5>a?.5*c.Easing.Bounce.In(2*a):.5*c.Easing.Bounce.Out(2*a-1)+.5}}};c.Interpolation={Linear:function(a,b){var d=a.length-1,e=d*b,g=Math.floor(e),
m=c.Interpolation.Utils.Linear;return 0>b?m(a[0],a[1],e):1<b?m(a[d],a[d-1],d-e):m(a[g],a[g+1>d?d:g+1],e-g)},Bezier:function(a,b){for(var d=0,e=a.length-1,g=Math.pow,m=c.Interpolation.Utils.Bernstein,h=0;h<=e;h++)d+=g(1-b,e-h)*g(b,h)*a[h]*m(e,h);return d},CatmullRom:function(a,b){var d=a.length-1,e=d*b,g=Math.floor(e),m=c.Interpolation.Utils.CatmullRom;return a[0]===a[d]?(0>b&&(g=Math.floor(e=d*(1+b))),m(a[(g-1+d)%d],a[g],a[(g+1)%d],a[(g+2)%d],e-g)):0>b?a[0]-(m(a[0],a[0],a[1],a[1],-e)-a[0]):1<b?a[d]-
(m(a[d],a[d],a[d-1],a[d-1],e-d)-a[d]):m(a[g?g-1:0],a[g],a[d<g+1?d:g+1],a[d<g+2?d:g+2],e-g)},Utils:{Linear:function(a,b,c){return(b-a)*c+a},Bernstein:function(a,b){var d=c.Interpolation.Utils.Factorial;return d(a)/d(b)/d(a-b)},Factorial:function(){var a=[1];return function(b){var c=1;if(a[b])return a[b];for(var d=b;1<d;d--)c*=d;return a[b]=c}}(),CatmullRom:function(a,b,c,e,h){a=.5*(c-a);e=.5*(e-b);var d=h*h;return(2*b-2*c+a+e)*h*d+(-3*b+3*c-2*a-e)*d+a*h+b}}};a.exports=c});B.prototype=Object.assign(Object.create(e.Sprite.prototype),
{constructor:B,setContainer:function(a){if(a instanceof HTMLElement)var b=a;else a&&a.container&&(b=a.container);b&&this.element&&b.appendChild(this.element);this.container=b},getContainer:function(){return this.container},onClick:function(a){this.element&&this.getContainer()&&(this.onHoverStart(a),this.lockHoverElement())},onDismiss:function(){this.element&&(this.unlockHoverElement(),this.onHoverEnd())},onHover:function(a){if(!this.isHovering)this.onHoverStart(a)},onHoverStart:function(a){if(this.loaded&&
this.getContainer()){var b=this.cursorStyle||(this.mode===u.NORMAL?"pointer":"default"),c=this.scaleDownAnimation,d=this.scaleUpAnimation,e=this.element;this.isHovering=!0;this.container.style.cursor=b;this.animated&&(c.stop(),d.start());e&&0<=a.mouseEvent.clientX&&0<=a.mouseEvent.clientY&&(a=e.left,b=e.right,c=e.style,this.mode===u.CARDBOARD||this.mode===u.STEREO?(c.display="none",a.style.display="block",b.style.display="block",e._width=a.clientWidth,e._height=a.clientHeight):(c.display="block",
a&&(a.style.display="none"),b&&(b.style.display="none"),e._width=e.clientWidth,e._height=e.clientHeight))}},onHoverEnd:function(){if(this.getContainer()){var a=this.scaleDownAnimation,b=this.scaleUpAnimation,c=this.element;this.isHovering=!1;this.container.style.cursor="default";this.animated&&(b.stop(),a.start());c&&!this.element.locked&&(a=c.left,b=c.right,c.style.display="none",a&&(a.style.display="none"),b&&(b.style.display="none"),this.unlockHoverElement())}},onDualEyeEffect:function(a){if(this.getContainer()){this.mode=
a.mode;a=this.element;var b=this.container.clientWidth/2;var c=this.container.clientHeight/2;a&&(a.left||a.right||(a.left=a.cloneNode(!0),a.right=a.cloneNode(!0)),this.mode===u.CARDBOARD||this.mode===u.STEREO?(a.left.style.display=a.style.display,a.right.style.display=a.style.display,a.style.display="none"):(a.style.display=a.left.style.display,a.left.style.display="none",a.right.style.display="none"),this.translateElement(b,c),this.container.appendChild(a.left),this.container.appendChild(a.right))}},
translateElement:function(a,b){if(this.element._width&&this.element._height&&this.getContainer()){var c=this.container;var d=this.element;var e=d._width/2;var l=d._height/2;var k=void 0!==d.verticalDelta?d.verticalDelta:40;var h=a-e;var m=b-l-k;this.mode!==u.CARDBOARD&&this.mode!==u.STEREO||!d.left||!d.right||a===c.clientWidth/2&&b===c.clientHeight/2?this.setElementStyle("transform",d,"translate("+h+"px, "+m+"px)"):(h=c.clientWidth/4-e+(a-c.clientWidth/2),m=c.clientHeight/2-l-k+(b-c.clientHeight/
2),this.setElementStyle("transform",d.left,"translate("+h+"px, "+m+"px)"),h+=c.clientWidth/2,this.setElementStyle("transform",d.right,"translate("+h+"px, "+m+"px)"))}},setElementStyle:function(a,b,c){b=b.style;"transform"===a&&(b.webkitTransform=b.msTransform=b.transform=c)},setText:function(a){this.element&&(this.element.textContent=a)},setCursorHoverStyle:function(a){this.cursorStyle=a},addHoverText:function(a,b){b=void 0===b?40:b;this.element||(this.element=document.createElement("div"),this.element.style.display=
"none",this.element.style.color="#fff",this.element.style.top=0,this.element.style.maxWidth="50%",this.element.style.maxHeight="50%",this.element.style.textShadow="0 0 3px #000000",this.element.style.fontFamily='"Trebuchet MS", Helvetica, sans-serif',this.element.style.position="absolute",this.element.classList.add("panolens-infospot"),this.element.verticalDelta=b);this.setText(a)},addHoverElement:function(a,b){b=void 0===b?40:b;this.element||(this.element=a.cloneNode(!0),this.element.style.display=
"none",this.element.style.top=0,this.element.style.position="absolute",this.element.classList.add("panolens-infospot"),this.element.verticalDelta=b)},removeHoverElement:function(){this.element&&(this.element.left&&(this.container.removeChild(this.element.left),this.element.left=null),this.element.right&&(this.container.removeChild(this.element.right),this.element.right=null),this.container.removeChild(this.element),this.element=null)},lockHoverElement:function(){this.element&&(this.element.locked=
!0)},unlockHoverElement:function(){this.element&&(this.element.locked=!1)},enableRaycast:function(a){this.raycast=void 0===a||a?this.originalRaycast:function(){}},show:function(a){a=void 0===a?0:a;var b=this.hideAnimation,c=this.showAnimation,d=this.material;this.animated?(b.stop(),c.delay(a).start()):(this.enableRaycast(!0),d.opacity=1)},hide:function(a){a=void 0===a?0:a;var b=this.hideAnimation,c=this.showAnimation,d=this.material;this.animated?(c.stop(),b.delay(a).start()):(this.enableRaycast(!1),
d.opacity=0)},setFocusMethod:function(a){a&&(this.HANDLER_FOCUS=a.method)},focus:function(a,b){this.HANDLER_FOCUS&&(this.HANDLER_FOCUS(this.position,a,b),this.onDismiss())},dispose:function(){var a=this.geometry,b=this.material,c=b.map;this.removeHoverElement();this.parent&&this.parent.remove(this);c&&(c.dispose(),b.map=null);a&&(a.dispose(),this.geometry=null);b&&(b.dispose(),this.material=null)}});var pa={tEquirect:{value:new e.Texture},repeat:{value:new e.Vector2(1,1)},offset:{value:new e.Vector2(0,
0)},opacity:{value:1}},qa={tEquirect:{value:new e.Texture},repeat:{value:new e.Vector2(1,1)},offset:{value:new e.Vector2(0,0)},opacity:{value:1}};n.prototype=Object.assign(Object.create(e.Mesh.prototype),{constructor:n,createGeometry:function(a){return"slider_panorama"==this.subtype?new e.PlaneBufferGeometry(1,1):"image_little_planet"==this.subtype?new e.BoxBufferGeometry(a,a,a):new e.SphereBufferGeometry(5050,100,80)},createMaterial:function(a,b){a=void 0===a?new e.Vector2(1,1):a;b=void 0===b?new e.Vector2(0,
0):b;if("slider_panorama"==this.subtype){var c="\n            #ifdef GL_ES\n            precision highp float;\n            #endif\n\n            varying vec2 texcoord;\n            uniform sampler2D tEquirect;\n\n            void main()\n            {\n                /* Set color of the fragment */\n                gl_FragColor = texture2D(tEquirect, texcoord);}\n                \n    ";var d="\n            #ifdef GL_ES\n            precision highp float;\n            #endif\n\n            varying vec2 texcoord;\n\n            void main()\n            {\n                gl_Position = projectionMatrix * modelViewMatrix * vec4(position,1.0);\n                texcoord  = uv;\n            }\n    ";
var g=e.UniformsUtils.clone(qa)}else c="\n        uniform sampler2D tEquirect;\n        uniform vec2 repeat;\n        uniform vec2 offset;\n        uniform float opacity;\n        varying vec3 vWorldDirection;\n        #include <common>\n        void main() {\n            vec3 direction = normalize( vWorldDirection );\n            vec2 sampleUV;\n            sampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n            sampleUV.x = atan( -direction.z, -direction.x ) * RECIPROCAL_PI2 + 0.5;\n            sampleUV *= repeat;\n            sampleUV += offset;\n            sampleUV.x = fract(sampleUV.x);\n            sampleUV.y = fract(sampleUV.y);\n            gl_FragColor = vec4(texture2D( tEquirect, sampleUV ).rgb, opacity);\n        }\n    ",
d="\n        varying vec3 vWorldDirection;\n        #include <common>\n        void main() {\n            vWorldDirection = transformDirection( position, modelMatrix );\n            #include <begin_vertex>\n            #include <project_vertex>\n        }\n    ",g=e.UniformsUtils.clone(pa);g.repeat.value.copy(a);g.offset.value.copy(b);g.opacity.value=0;return new e.ShaderMaterial({fragmentShader:c,vertexShader:d,uniforms:g,side:e.DoubleSide,transparent:!0})},add:function(a){if(1<arguments.length){for(var b=
0;b<arguments.length;b++)this.add(arguments[b]);return this}a instanceof B&&((b=this.container)&&a.dispatchEvent({type:"panolens-container",container:b}),a.dispatchEvent({type:"panolens-infospot-focus",method:function(a,b,e){this.dispatchEvent({type:"panolens-viewer-handler",method:"tweenControlCenter",data:[a,b,e]})}.bind(this)}));e.Object3D.prototype.add.call(this,a);this.dispatchEvent({type:"addChild"})},getTexture:function(){return this.material.uniforms.tEquirect.value},load:function(a){a=void 0===
a?!0:a;this.dispatchEvent({type:"load-start"});if(a)this.onLoad()},onClick:function(a){a.intersects&&0===a.intersects.length&&this.traverse(function(a){a.dispatchEvent({type:"dismiss"})})},setContainer:function(a){if(a instanceof HTMLElement)var b=a;else a&&a.container&&(b=a.container);b&&(this.children.forEach(function(a){a instanceof B&&a.dispatchEvent&&a.dispatchEvent({type:"panolens-container",container:b})}),this.container=b)},onLoad:function(){this.loaded=!0;this.dispatchEvent({type:"loaded"});
this.dispatchEvent({type:"ready"})},onProgress:function(a){this.dispatchEvent({type:"progress",progress:a})},onError:function(){this.dispatchEvent({type:"error"})},getZoomLevel:function(){return 800>=window.innerWidth?this.ImageQualityFair:800<window.innerWidth&&1280>=window.innerWidth?this.ImageQualityMedium:1280<window.innerWidth&&1920>=window.innerWidth?this.ImageQualityHigh:1920<window.innerWidth?this.ImageQualitySuperHigh:this.ImageQualityLow},updateTexture:function(a){this.material.uniforms.tEquirect.value=
a},toggleInfospotVisibility:function(a,b){b=void 0!==b?b:0;var c=void 0!==a?a:this.isInfospotVisible?!1:!0;this.traverse(function(a){a instanceof B&&(c?a.show(b):a.hide(b))});this.isInfospotVisible=c;this.infospotAnimation.onComplete(function(){this.dispatchEvent({type:"infospot-animation-complete",visible:c})}.bind(this)).delay(b).start()},reset:function(){this.children.length=0},setupTransitions:function(){this.fadeInAnimation=new h.Tween;this.fadeOutAnimation=new h.Tween;this.enterTransition=(new h.Tween(this)).easing(h.Easing.Quartic.Out).onComplete(function(){this.dispatchEvent({type:"enter-complete"})}.bind(this)).start();
this.leaveTransition=(new h.Tween(this)).easing(h.Easing.Quartic.Out)},fadeIn:function(a){a=void 0===a?this.animationDuration:a;var b=this.material.uniforms.opacity,c=function(){this.visible=!0;this.dispatchEvent({type:"enter-fade-start"})}.bind(this),d=function(){this.toggleInfospotVisibility(!0,a/2);this.dispatchEvent({type:"enter-fade-complete"})}.bind(this);this.fadeOutAnimation.stop();this.fadeInAnimation=(new h.Tween(b)).to({value:1},a).easing(h.Easing.Quartic.Out).onStart(c).onComplete(d).start()},
fadeOut:function(a){a=void 0===a?this.animationDuration:a;var b=this.material.uniforms.opacity,c=function(){this.visible=!1;this.dispatchEvent({type:"leave-complete"})}.bind(this);this.fadeInAnimation.stop();this.fadeOutAnimation=(new h.Tween(b)).to({value:0},a).easing(h.Easing.Quartic.Out).onComplete(c).start()},onEnter:function(){var a=this.animationDuration;this.dispatchEvent({type:"enter"});this.leaveTransition.stop();this.enterTransition.to({},a).onStart(function(){this.dispatchEvent({type:"enter-start"});
this.loaded?this.dispatchEvent({type:"ready"}):this.load()}.bind(this)).start();this.children.forEach(function(a){a.dispatchEvent({type:"panorama-enter"})});this.active=!0},onLeave:function(){var a=this.animationDuration;this.enterTransition.stop();this.leaveTransition.to({},a).onStart(function(){this.dispatchEvent({type:"leave-start"});this.fadeOut(a);this.toggleInfospotVisibility(!1)}.bind(this)).start();this.dispatchEvent({type:"leave"});this.traverse(function(a){return a.dispatchEvent({type:"panorama-leave"})});
this.active=!1},dispose:function(){function a(b){for(var d=b.geometry,c=b.material,e=b.children.length-1;0<=e;e--)a(b.children[e]),b.remove(b.children[e]);b instanceof B&&b.dispose();d&&(d.dispose(),b.geometry=null);c&&(c.dispose(),b.material=null)}var b=this.material;b&&b.uniforms&&b.uniforms.tEquirect&&b.uniforms.tEquirect.value.dispose();this.infospotAnimation.stop();this.fadeInAnimation.stop();this.fadeOutAnimation.stop();this.enterTransition.stop();this.leaveTransition.stop();this.dispatchEvent({type:"panolens-viewer-handler",
method:"onPanoramaDispose",data:this});a(this);this.parent&&this.parent.remove(this)}});v.prototype=Object.assign(Object.create(n.prototype),{constructor:v,load:function(a){n.prototype.load.call(this,!1);a=a||this.src;if(!a)console.warn("Image source undefined");else if("string"===typeof a)M.load(a,this.onLoad.bind(this),this.onProgress.bind(this),this.onError.bind(this));else if(a instanceof HTMLImageElement)this.onLoad(new e.Texture(a))},onLoad:function(a){a.minFilter=a.magFilter=e.LinearFilter;
a.needsUpdate=!0;this.updateTexture(a);window.requestAnimationFrame(n.prototype.onLoad.bind(this))},reset:function(){n.prototype.reset.call(this)},dispose:function(){e.Cache.remove(this.src);n.prototype.dispose.call(this)}});V.prototype=Object.assign(Object.create(n.prototype),{constructor:V});N.prototype=Object.assign(Object.create(n.prototype),{constructor:N,createMaterial:function(){var a=e.ShaderLib.cube,b=a.fragmentShader,c=a.vertexShader;a=e.UniformsUtils.clone(a.uniforms);a.opacity.value=0;
return new e.ShaderMaterial({fragmentShader:b,vertexShader:c,uniforms:a,side:e.BackSide,transparent:!0,opacity:0})},load:function(){n.prototype.load.call(this,!1);la.load(this.images,this.onLoad.bind(this),this.onProgress.bind(this),this.onError.bind(this))},onLoad:function(a){this.material.uniforms.tCube.value=a;n.prototype.onLoad.call(this)},getTexture:function(){return this.material.uniforms.tCube.value},dispose:function(){var a=this.material.uniforms.tCube.value;this.images.forEach(function(a){e.Cache.remove(a)});
a instanceof e.CubeTexture&&a.dispose();n.prototype.dispose.call(this)}});W.prototype=Object.assign(Object.create(N.prototype),{constructor:W});K.prototype=Object.assign(Object.create(n.prototype),{constructor:K,hide:function(){},load:function(a){a=a||this.src;if(!a)console.warn("Image source undefined");else if("string"===typeof a)M.load(a,this.onLoad.bind(this),this.onProgress.bind(this),this.onError.bind(this));else if(a instanceof HTMLImageElement)this.onLoad(new e.Texture(a))},onLoad:function(a){a.minFilter=
a.magFilter=e.LinearFilter;a.needsUpdate=!0;this.updateTexture(a);window.requestAnimationFrame(n.prototype.onLoad.bind(this))},reset:function(){n.prototype.reset.call(this)},dispose:function(){if(this.material){var a=this.material.map;a&&a.dispose()}e.Cache.remove(this.src);n.prototype.dispose.call(this)}});var ra={tDiffuse:{value:new e.Texture},resolution:{value:1},transform:{value:new e.Matrix4},zoom:{value:1},opacity:{value:1}};G.prototype=Object.assign(Object.create(v.prototype),{constructor:G,
add:function(a){if(1<arguments.length){for(var b=0;b<arguments.length;b++)this.add(arguments[b]);return this}a instanceof B&&(a.material.depthTest=!1);v.prototype.add.call(this,a)},createGeometry:function(a){return new e.PlaneBufferGeometry(a,.5*a)},createMaterial:function(a){a=void 0===a?this.edgeLength:a;var b=e.UniformsUtils.clone(ra);b.zoom.value=a;b.opacity.value=0;return new e.ShaderMaterial({vertexShader:"\n\n        varying vec2 vUv;\n\n        void main() {\n\n            vUv = uv;\n            gl_Position = vec4( position, 1.0 );\n\n        }\n\n    ",
fragmentShader:"\n\n        uniform sampler2D tDiffuse;\n        uniform float resolution;\n        uniform mat4 transform;\n        uniform float zoom;\n        uniform float opacity;\n\n        varying vec2 vUv;\n\n        const float PI = 3.141592653589793;\n\n        void main(){\n\n            vec2 position = -1.0 +  2.0 * vUv;\n\n            position *= vec2( zoom * resolution, zoom * 0.5 );\n\n            float x2y2 = position.x * position.x + position.y * position.y;\n            vec3 sphere_pnt = vec3( 2. * position, x2y2 - 1. ) / ( x2y2 + 1. );\n\n            sphere_pnt = vec3( transform * vec4( sphere_pnt, 1.0 ) );\n\n            vec2 sampleUV = vec2(\n                (atan(sphere_pnt.y, sphere_pnt.x) / PI + 1.0) * 0.5,\n                (asin(sphere_pnt.z) / PI + 0.5)\n            );\n\n            gl_FragColor = texture2D( tDiffuse, sampleUV );\n            gl_FragColor.a *= opacity;\n\n        }\n    ",
uniforms:b,transparent:!0,opacity:0})},registerMouseEvents:function(){this.container.addEventListener("mousedown",this.onMouseDown.bind(this),{passive:!0});this.container.addEventListener("mousemove",this.onMouseMove.bind(this),{passive:!0});this.container.addEventListener("mouseup",this.onMouseUp.bind(this),{passive:!0});this.container.addEventListener("touchstart",this.onMouseDown.bind(this),{passive:!0});this.container.addEventListener("touchmove",this.onMouseMove.bind(this),{passive:!0});this.container.addEventListener("touchend",
this.onMouseUp.bind(this),{passive:!0});this.container.addEventListener("mousewheel",this.onMouseWheel.bind(this),{passive:!1});this.container.addEventListener("DOMMouseScroll",this.onMouseWheel.bind(this),{passive:!1});this.container.addEventListener("contextmenu",this.onContextMenu.bind(this),{passive:!0})},unregisterMouseEvents:function(){this.container.removeEventListener("mousedown",this.onMouseDown.bind(this),!1);this.container.removeEventListener("mousemove",this.onMouseMove.bind(this),!1);
this.container.removeEventListener("mouseup",this.onMouseUp.bind(this),!1);this.container.removeEventListener("touchstart",this.onMouseDown.bind(this),!1);this.container.removeEventListener("touchmove",this.onMouseMove.bind(this),!1);this.container.removeEventListener("touchend",this.onMouseUp.bind(this),!1);this.container.removeEventListener("mousewheel",this.onMouseWheel.bind(this),!1);this.container.removeEventListener("DOMMouseScroll",this.onMouseWheel.bind(this),!1);this.container.removeEventListener("contextmenu",
this.onContextMenu.bind(this),!1)},onMouseDown:function(a){switch(a.touches&&a.touches.length||1){case 1:var b=0<=a.clientX?a.clientX:a.touches[0].clientX;a=0<=a.clientY?a.clientY:a.touches[0].clientY;this.dragging=!0;this.userMouse.set(b,a);break;case 2:b=a.touches[0].pageX-a.touches[1].pageX,a=a.touches[0].pageY-a.touches[1].pageY,this.userMouse.pinchDistance=Math.sqrt(b*b+a*a)}this.onUpdateCallback()},onMouseMove:function(a){switch(a.touches&&a.touches.length||1){case 1:var b=0<=a.clientX?a.clientX:
a.touches[0].clientX;a=0<=a.clientY?a.clientY:a.touches[0].clientY;var c=.4*e.Math.degToRad(b-this.userMouse.x),d=.4*e.Math.degToRad(a-this.userMouse.y);this.dragging&&(this.quatA.setFromAxisAngle(this.vectorY,c),this.quatB.setFromAxisAngle(this.vectorX,d),this.quatCur.multiply(this.quatA).multiply(this.quatB),this.userMouse.set(b,a));break;case 2:b=a.touches[0].pageX-a.touches[1].pageX,a=a.touches[0].pageY-a.touches[1].pageY,this.addZoomDelta(this.userMouse.pinchDistance-Math.sqrt(b*b+a*a))}},onMouseUp:function(){this.dragging=
!1},onMouseWheel:function(a){a.preventDefault();a.stopPropagation();var b=0;void 0!==a.wheelDelta?b=a.wheelDelta:void 0!==a.detail&&(b=-a.detail);this.addZoomDelta(b);this.onUpdateCallback()},addZoomDelta:function(a){var b=this.material.uniforms,c=.1*this.size,d=10*this.size;b.zoom.value+=a;b.zoom.value<=c?b.zoom.value=c:b.zoom.value>=d&&(b.zoom.value=d)},onUpdateCallback:function(){this.frameId=window.requestAnimationFrame(this.onUpdateCallback.bind(this));this.quatSlerp.slerp(this.quatCur,.1);this.material&&
this.material.uniforms.transform.value.makeRotationFromQuaternion(this.quatSlerp);!this.dragging&&1-this.quatSlerp.clone().dot(this.quatCur)<this.EPS&&window.cancelAnimationFrame(this.frameId)},reset:function(){this.quatCur.set(0,0,0,1);this.quatSlerp.set(0,0,0,1);this.onUpdateCallback()},updateTexture:function(a){this.material.uniforms.tDiffuse.value=a},getTexture:function(){return this.material.uniforms.tDiffuse.value},onLoad:function(a){this.material.uniforms.resolution.value=this.container.clientWidth/
this.container.clientHeight;this.registerMouseEvents();this.onUpdateCallback();this.dispatchEvent({type:"panolens-viewer-handler",method:"disableControl"});v.prototype.onLoad.call(this,a)},onLeave:function(){this.unregisterMouseEvents();this.dispatchEvent({type:"panolens-viewer-handler",method:"enableControl",data:C.ORBIT});window.cancelAnimationFrame(this.frameId);v.prototype.onLeave.call(this)},onWindowResize:function(){this.material.uniforms.resolution.value=this.container.clientWidth/this.container.clientHeight},
onContextMenu:function(){this.dragging=!1},dispose:function(){this.unregisterMouseEvents();v.prototype.dispose.call(this)}});var P={uniforms:{tDiffuse1:{value:null},tDiffuse2:{value:null},mixRatio:{value:0},threshold:{value:.3},useTexture:{value:0},tMixTexture:{value:null}},vertexShader:"varying vec2 vUv;\nvoid main() {\nvUv = vec2( uv.x, uv.y );\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform float mixRatio;\nuniform sampler2D tDiffuse1;\nuniform sampler2D tDiffuse2;\nuniform sampler2D tMixTexture;\nuniform int useTexture;\nuniform float threshold;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texel1 = texture2D( tDiffuse1, vUv );\n\tvec4 texel2 = texture2D( tDiffuse2, vUv );\n\tif (useTexture==1) {\n\t\tvec4 transitionTexel = texture2D( tMixTexture, vUv );\n\t\tfloat r = mixRatio * (1.0 + threshold * 2.0) - threshold;\n\t\tfloat mixf=clamp((transitionTexel.r - r)*(1.0/threshold), 0.0, 1.0);\n\t\tgl_FragColor = mix( texel1, texel2, mixf );\n\t} else {\n\t\tgl_FragColor = mix( texel2, texel1, mixRatio );\n\t}\n}"};
X.prototype={constructor:X};Z.prototype=Object.assign(Object.create(e.EventDispatcher.prototype),{constructor:Z,add:function(a){this.viewer?(this.targetViewer=a,this.viewersQueue.push(a)):(this.viewer=a,this.viewersQueue.push(a),this.transition=new Y(null,this.viewer,this.renderer,this.options.transitionParams),this.transition.execute());this.shareStateBetweenViewers()},updateTransitionType:function(a){a={type:a};this.options.transitionParams=Object.assign({},this.options.transitionParams,a);this.viewer.options.transitionParams=
Object.assign({},this.viewer.options.transitionParams,a)},setControlEnabled:function(a){a={controlEnabled:void 0===a?!0:a};this.options.transitionParams=Object.assign({},this.options.transitionParams,a);this.viewer.options.transitionParams=Object.assign({},this.viewer.options.transitionParams,a);this.updateTransition()},updateTransition:function(){this.transition=new Y(null,this.viewer,this.renderer,this.options.transitionParams);this.transition.execute()},shareStateBetweenViewers:function(a){var b=
this;this.options=this.viewer.options;this.mode=this.viewer.mode;this.controlIndex=this.viewer.getControlIndex();this.targetViewer&&(this.mode!=this.targetViewer.mode&&this.targetViewer.enableEffect(this.mode),this.controlIndex!=this.targetViewer.getControlIndex()&&this.targetViewer.enableControl(this.controlIndex,!1),this.targetViewer.OrbitControls.minPolarAngle=this.viewer.OrbitControls.minPolarAngle,this.targetViewer.OrbitControls.maxPolarAngle=this.viewer.OrbitControls.maxPolarAngle,"slider_panorama"==
this.targetViewer.panorama.subtype?(this.targetViewer.OrbitControls.enableDamping=!1,this.targetViewer.OrbitControls.autoRotate=!1,this.targetViewer.OrbitControls.update(),this.targetViewer.OrbitControls.enableDamping=!0):(this.targetViewer.OrbitControls.enableDamping=!1,this.targetViewer.OrbitControls.autoRotate="slider_panorama"==this.viewer.panorama.subtype?this.autoRotate:this.viewer.OrbitControls.autoRotate,this.targetViewer.OrbitControls.update(),this.targetViewer.OrbitControls.enableDamping=
!0,this.viewer.addEventListener("enableAutoRotate",function(){return b.viewer.OrbitControls.autoRotate=!0})))},setScene:function(a,b){a===this.targetViewer&&(this.transition=new Y(this.viewer,this.targetViewer,this.renderer,this.options.transitionParams,void 0===b?!1:b),this.transition.execute(),2<this.viewersQueue.length&&(b=this.viewersQueue.shift(),b.dispose(),b.destroy()),this.viewer=a,this.targetViewer=null)},getRenderer:function(){return this.renderer},getContainer:function(){return this.container},
render:function(){this.transition&&this.transition.render()},animate:function(){this.requestAnimationId=requestAnimationFrame(this.animate.bind(this));this.render()},destroy:function(){this.render();window.cancelAnimationFrame(this.requestAnimationId)}});aa.prototype=Object.assign(Object.create(G.prototype),{constructor:aa,onLoad:function(a){this.updateTexture(a);G.prototype.onLoad.call(this,a)},updateTexture:function(a){a.minFilter=a.magFilter=e.LinearFilter;this.material.uniforms.tDiffuse.value=
a},dispose:function(){var a=this.material.uniforms.tDiffuse;a&&a.value&&a.value.dispose();G.prototype.dispose.call(this)}});ba.prototype=Object.assign(Object.create(e.EventDispatcher.prototype),{constructor:ba});ca.prototype=Object.assign(Object.create(e.EventDispatcher.prototype),{constructor:ca});T.prototype=Object.create(e.EventDispatcher.prototype);T.prototype.constructor=T;Object.assign(U.prototype,{constructor:U,updateUniformByFormat:function(a,b){this.format=a;var c=b.repeat.value;b=b.offset.value;
var d=this.loffset,e=this.roffset;switch(a){case H.TAB:c.set(1,.5);b.set(0,.5);d.set(0,.5);e.set(0,0);break;case H.SBS:c.set(.5,1),b.set(0,0),d.set(0,0),e.set(.5,0)}},updateTextureToLeft:function(a){a.copy(this.loffset)},updateTextureToRight:function(a){a.copy(this.roffset)}});da.prototype=Object.assign(Object.create(v.prototype),{constructor:da,onLoad:function(a){var b=a.image;this.stereo.updateUniformByFormat(4===b.width/b.height?H.SBS:H.TAB,this.material.uniforms);this.material.uniforms.tEquirect.value=
a;v.prototype.onLoad.call(this,a)},updateTextureToLeft:function(){this.stereo.updateTextureToLeft(this.material.uniforms.offset.value)},updateTextureToRight:function(){this.stereo.updateTextureToRight(this.material.uniforms.offset.value)},dispose:function(){var a=this.material.uniforms.tEquirect.value;a instanceof e.Texture&&a.dispose();v.prototype.dispose.call(this)}});var ea=0;I.prototype=Object.assign(Object.create(n.prototype),{constructor:I,isMobile:function(){var a=!1,b=window.navigator.userAgent||
window.navigator.vendor||window.opera;if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(b)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(b.substr(0,
4)))a=!0;return a},load:function(){var a=this.options,b=a.muted,c=a.loop,d=a.autoplay,e=a.playsinline;a=a.crossOrigin;var l=this.videoElement,k=this.material,h=this.onProgress.bind(this),m=this.onLoad.bind(this);l.loop=c;l.autoplay=d;l.playsinline=e;l.crossOrigin=a;l.muted=b;e&&(l.setAttribute("playsinline",""),l.setAttribute("webkit-playsinline",""));e=function(){this.setVideoTexture(l);d&&this.dispatchEvent({type:"panolens-viewer-handler",method:"updateVideoPlayButton",data:!1});this.isMobile()&&
(l.pause(),d&&b?this.dispatchEvent({type:"panolens-viewer-handler",method:"updateVideoPlayButton",data:!1}):this.dispatchEvent({type:"panolens-viewer-handler",method:"updateVideoPlayButton",data:!0}));window.requestAnimationFrame(function(){k.map.needsUpdate=!0;h({loaded:1,total:1});m()})};2<l.readyState?e.call(this):(0===l.querySelectorAll("source").length&&(a=document.createElement("source"),a.src=this.src,l.appendChild(a)),l.load());l.addEventListener("loadeddata",e.bind(this));l.addEventListener("timeupdate",
function(){this.videoProgress=0<=l.duration?l.currentTime/l.duration:0;this.dispatchEvent({type:"panolens-viewer-handler",method:"onVideoUpdate",data:this.videoProgress})}.bind(this));l.addEventListener("ended",function(){c||(this.resetVideo(),this.dispatchEvent({type:"panolens-viewer-handler",method:"updateVideoPlayButton",data:!0}))}.bind(this),!1)},setVideoTexture:function(a){a&&(a=new e.VideoTexture(a),a.minFilter=e.LinearFilter,a.magFilter=e.LinearFilter,a.format=e.RGBFormat,this.updateTexture(a))},
reset:function(){this.videoElement=void 0;n.prototype.reset.call(this)},isVideoPaused:function(){return this.videoElement.paused},toggleVideo:function(){var a=this.videoElement;if(a)a[a.paused?"play":"pause"]()},setVideoCurrentTime:function(a){a=a.percentage;var b=this.videoElement;b&&!Number.isNaN(a)&&1!==a&&(b.currentTime=b.duration*a,this.dispatchEvent({type:"panolens-viewer-handler",method:"onVideoUpdate",data:a}))},playVideo:function(){var a=this.videoElement,b=this.playVideo.bind(this),c=this.dispatchEvent.bind(this),
d=function(){c({type:"play"})},e=function(a){window.requestAnimationFrame(b);c({type:"play-error",error:a})};a&&a.paused&&a.play().then(d).catch(e)},pauseVideo:function(){var a=this.videoElement;a&&!a.paused&&a.pause();this.dispatchEvent({type:"pause"})},resumeVideoProgress:function(){var a=this.videoElement;4<=a.readyState&&a.autoplay&&!this.isMobile()?(this.playVideo(),this.dispatchEvent({type:"panolens-viewer-handler",method:"updateVideoPlayButton",data:!1})):(this.pauseVideo(),this.dispatchEvent({type:"panolens-viewer-handler",
method:"updateVideoPlayButton",data:!0}));this.setVideoCurrentTime({percentage:this.videoProgress})},resetVideo:function(){this.videoElement&&this.setVideoCurrentTime({percentage:0})},isVideoMuted:function(){return this.videoElement.muted},muteVideo:function(){var a=this.videoElement;a&&!a.muted&&(a.muted=!0);this.dispatchEvent({type:"volumechange"})},unmuteVideo:function(){var a=this.videoElement;a&&this.isVideoMuted()&&(a.muted=!1);this.dispatchEvent({type:"volumechange"})},getVideoElement:function(){return this.videoElement},
dispose:function(){var a=this.material.map;this.pauseVideo();this.removeEventListener("leave",this.pauseVideo.bind(this));this.removeEventListener("enter-fade-start",this.resumeVideoProgress.bind(this));this.removeEventListener("video-toggle",this.toggleVideo.bind(this));this.removeEventListener("video-time",this.setVideoCurrentTime.bind(this));a&&a.dispose();n.prototype.dispose.call(this)}});fa.prototype=Object.assign(Object.create(I.prototype),{constructor:fa,onLoad:function(a){var b=a.image;this.stereo.updateUniformByFormat(4===
b.videoWidth/b.videoHeight?H.SBS:H.TAB,this.material.uniforms);this.material.uniforms.tEquirect.value=a;I.prototype.onLoad.call(this)},updateTextureToLeft:function(){this.stereo.updateTextureToLeft(this.material.uniforms.offset.value)},updateTextureToRight:function(){this.stereo.updateTextureToRight(this.material.uniforms.offset.value)},dispose:function(){var a=this.material.uniforms.tEquirect.value;a instanceof e.Texture&&a.dispose();I.prototype.dispose.call(this)}});var sa=function(a){var b=new e.StereoCamera;
b.aspect=.5;var c=new e.Vector2;this.setEyeSeparation=function(a){b.eyeSep=a};this.setSize=function(b,c){a.setSize(b,c)};this.render=function(d,e){d.updateMatrixWorld();null===e.parent&&e.updateMatrixWorld();b.update(e);a.getSize(c);a.autoClear&&a.clear();a.setScissorTest(!0);a.setScissor(0,0,c.width/2,c.height);a.setViewport(0,0,c.width/2,c.height);a.render(d,b.cameraL);a.setScissor(c.width/2,0,c.width/2,c.height);a.setViewport(c.width/2,0,c.width/2,c.height);a.render(d,b.cameraR);a.setScissorTest(!1)}},
ja=window.navigator.userAgent||window.navigator.vendor||window.opera;/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(ja)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(ja.substr(0,
4));var ma=/(android)/i.test(ja),ka=navigator.userAgent.match(/iPhone|iPad|iPod/i)?!0:!1;ha.prototype=Object.assign(Object.create(e.EventDispatcher.prototype),{constructor:ha,setupScene:function(a){return a=void 0===a?new e.Scene:a},setupCamera:function(a,b,c){c=void 0===c?new e.PerspectiveCamera(a,b,1,1E4):c;c.position.z=1;return c},setupRenderer:function(a,b){return a=void 0===a?new e.WebGLRenderer({alpha:!0,antialias:!1}):a},setupControls:function(a,b){var c=this.options,d=c.autoRotate,e=c.autoRotateSpeed,
l=c.horizontalView,k=c.momentum,h=c.rotateSpeed,m=c.dampingFactor;c=new ba(a,b);c.id="orbit";c.index=C.ORBIT;c.minDistance=1;c.noPan=!0;c.autoRotate=d;c.autoRotateSpeed=e;c.momentum=k;c.rotateSpeed=h;c.dampingFactor=m;c.enabled=!0;a=new ca(a,b);a.id="device-orientation";a.index=C.DEVICEORIENTATION;a.enabled=!1;l&&(c.minPolarAngle=Math.PI/2,c.maxPolarAngle=Math.PI/2);l={id:"object"};l.index=C.OBJECT;l.enabled=!1;b={id:"drag"};b.index=C.DRAG;b.enabled=!1;this.controls=[c,a,l,b];this.OrbitControls=c;
this.DeviceOrientationControls=a;this.ObjectControls=l;this.DragControls=b;return c},setupEffects:function(a,b){var c=b.clientWidth;b=b.clientHeight;var d=new na(a);d.setSize(c,b);a=new sa(a);a.setSize(c,b);this.CardboardEffect=d;this.StereoEffect=a;return d},setupContainer:function(a){a._width=a.clientWidth;a._height=a.clientHeight;return a},setupTween:function(){this.tweenCanvasOpacityOut.to({},500).easing(h.Easing.Exponential.Out);this.tweenCanvasOpacityIn.to({},500).easing(h.Easing.Exponential.Out);
this.tweenCanvasOpacityOut.chain(this.tweenCanvasOpacityIn)},add:function(a){var b=this,c=this.container,d=this.scene,e=this.camera,l=this.controls;if(1<arguments.length){for(d=0;d<arguments.length;d++)this.add(arguments[d]);return this}d.add(a);a.addEventListener&&a.addEventListener("panolens-viewer-handler",this.eventHandler.bind(this));a instanceof n&&(a.dispatchEvent({type:"panolens-container",container:c}),a.dispatchEvent({type:"panolens-scene",scene:d}),a.dispatchEvent({type:"panolens-camera",
camera:e}),a.dispatchEvent({type:"panolens-controls",controls:l}),this.addPanoramaEventListener(a),this.panorama||(c=this.options.initialLookAt,this.setPanorama(a),this.setControlCenter(c)));if(a instanceof K){this.camera.position.set(0,0,1);d.add(a);this.ObjectControls={};this.controls[C.OBJECT]={};var k=!1,p=(new h.Tween(a.position)).to({x:0,y:0,z:0},500).easing(h.Easing.Cubic.Out).onStart(function(){return k=!0}).onComplete(function(){return k=!1});a.addEventListener("addChild",this.fitObjectToScreenEvent.bind(this));
a.addEventListener("ready",function(){b.OrbitControls.addEventListener("fov",function(){b.camera.fov<b.defaultFov?b.DragControls.enabled=!0:(b.DragControls.enabled=!1,k||p.start());b.fitObjectToScreen(a)});b.DragControls=Object.assign(new T([a],b.camera,b.container),b.DragControls);b.DragControls.addEventListener("dragstart",function(){b.OrbitControls.enabled=!1});b.DragControls.addEventListener("dragend",function(){b.OrbitControls.enabled=!0});b.DragControls.activate();b.camera.fov<b.defaultFov&&
(b.DragControls.enabled=!0)});a.addEventListener("ready",this.fitObjectToScreenEvent.bind(this))}},fitObjectToScreenEvent:function(a){a.target instanceof K&&this.fitObjectToScreen(a.target)},fitObjectToScreen:function(a){var b=a.desiredWidth/a.desiredHeight;this.camera.lookAt(a.position);var c=2*Math.tan(Math.PI*this.camera.fov/360),d=this.defaultFov||60,g=1;g=c>c/this.camera.aspect*b?c:c*this.camera.aspect/b;g*=d/this.camera.fov;a.scale.set(g*b,g,1);a.children.forEach(function(a){if(!a.alreadyScaled){a.hide();
a.scale.set(a.scale.x/b,a.scale.y,a.scale.z);a._parentRatio=b;var c=new e.Vector3;c.copy(a.scale);a.scaleUpAnimation=(new h.Tween(a.scale)).to({x:1.3*c.x,y:1.3*c.y},500).easing(h.Easing.Elastic.Out);a.scaleDownAnimation=(new h.Tween(a.scale)).to({x:c.x,y:c.y},500).easing(h.Easing.Elastic.Out);null!=a.map&&(a.map.needsUpdate=!0);a.needsUpdate=!0;a.updateMatrix();a.alreadyScaled=!0;a.show()}});this.currentScale=g;this.currentRatio=b},remove:function(a){a.removeEventListener&&a.removeEventListener("panolens-viewer-handler",
this.eventHandler.bind(this));this.scene.remove(a)},setPanorama:function(a){var b=this.panorama;if(a instanceof n&&b!==a){this.hideInfospot();b&&(b._onReady&&(b.removeEventListener("ready",b._onReady),delete b._onReady),b.onLeave());a._onLeaveComplete&&(a.removeEventListener("leave-complete",a._onLeaveComplete),delete a._onLeaveComplete);var c=function(){a.removeEventListener("ready",c);delete a._onReady;a.active&&a.fadeIn()};a.addEventListener("ready",c);a._onReady=c;this.panorama=a;this.panorama.onEnter()}},
eventHandler:function(a){if(a.method&&this[a.method])this[a.method](a.data)},dispatchEventToChildren:function(a){this.scene.traverse(function(b){b.dispatchEvent&&b.dispatchEvent(a)})},enableEffect:function(a){if(this.mode!==a)if(a===u.NORMAL)this.disableEffect();else{this.mode=a;var b=this.camera.fov;switch(a){case u.CARDBOARD:this.effect=this.CardboardEffect;this.enableReticleControl();break;case u.STEREO:this.effect=this.StereoEffect;this.enableReticleControl();break;default:this.effect=null,this.disableReticleControl()}this.dispatchEventToChildren({type:"panolens-dual-eye-effect",
mode:this.mode});this.camera.fov=b+.01;this.effect.setSize(this.container.clientWidth,this.container.clientHeight);this.render();this.camera.fov=b;this.dispatchEvent({type:"mode-change",mode:this.mode});this.dispatchEvent({type:"viewerStateUpdate"})}},disableEffect:function(){this.mode!==u.NORMAL&&(this.mode=u.NORMAL,this.disableReticleControl(),this.dispatchEventToChildren({type:"panolens-dual-eye-effect",mode:this.mode}),this.renderer.setSize(this.container.clientWidth,this.container.clientHeight),
this.render(),this.dispatchEvent({type:"mode-change",mode:this.mode}),this.dispatchEvent({type:"viewerStateUpdate"}))},enableReticleControl:function(){this.reticle.visible||(this.tempEnableReticle=!0,this.unregisterMouseAndTouchEvents(),this.reticle.show(),this.registerReticleEvent(),this.updateReticleEvent())},disableReticleControl:function(){this.tempEnableReticle=!1;this.options.enableReticle?this.updateReticleEvent():(this.reticle.hide(),this.unregisterReticleEvent(),this.registerMouseAndTouchEvents())},
enableAutoRate:function(){this.options.autoRotate=!0;this.OrbitControls.autoRotate=!0;this.dispatchEvent({type:"enableAutoRotate"})},disableAutoRate:function(){clearTimeout(this.autoRotateRequestId);this.dispatchEvent({type:"viewerStateUpdate"});this.options.autoRotate=!1;this.OrbitControls.autoRotate=!1},addUpdateCallback:function(a){a&&this.updateCallbacks.push(a)},removeUpdateCallback:function(a){var b=this.updateCallbacks.indexOf(a);a&&0<=b&&this.updateCallbacks.splice(b,1)},addPanoramaEventListener:function(a){},
setControl:function(a){this.control=this.controls[a];this.dispatchEvent({type:"viewerStateUpdate"})},getControl:function(){return this.control},getScene:function(){return this.scene},getCamera:function(){return this.camera},getRenderer:function(){return this.renderer},getContainer:function(){return this.container},getControlId:function(){return this.control.id},getNextControlId:function(){return this.controls[this.getNextControlIndex()].id},getNextControlIndex:function(){var a=this.controls,b=a.indexOf(this.control)+
1;return b>=a.length?0:b},getControlIndex:function(){return this.controls.indexOf(this.control)},setCameraFov:function(a){this.camera.fov=a;this.camera.updateProjectionMatrix()},getRaycastViewCenter:function(){var a=new e.Raycaster;a.setFromCamera(new e.Vector2(0,0),this.camera);a=a.intersectObject(this.panorama);return 0<a.length?a[0].point:new e.Vector3(0,0,-1)},enableControl:function(a,b){a=void 0===a?C.ORBIT:a;b=void 0===b?!0:b;var c=this.control.index,d=this.OrbitControls,g=this.DeviceOrientationControls,
l=this.container,h=l.querySelector("canvas");if(a!==c){if(a===C.DEVICEORIENTATION)this.tweenCanvasOpacityOut.onStart(function(){d.enabled=!1;g.enabled=!1;b?h.style.opacity=0:null}),this.tweenCanvasOpacityIn.onStart(function(){d.enabled=!0;g.updateAlphaOffsetAngle(d.publicSphericalDelta.data.theta);g.connect();b?h.style.opacity=1:null}),this.tweenCanvasOpacityOut.start();else if(a===C.DEVICEORIENTATION){c=g.getRotations;c();var n=this.getRaycastViewCenter();this.tweenCanvasOpacityOut.onStart(function(){d.enabled=
!1;g.disconnect();h.style.opacity=0});this.tweenCanvasOpacityIn.onStart(function(){d.enabled=!0;this.setControlCenter(n);h.style.opacity=1}.bind(this));this.tweenCanvasOpacityOut.start()}else a==C.OBJECT&&(d.enabled=!1,g.enabled=!1,ObjectControls=Object.assign(new ObjectControls(camera,l,new e.MeshBasicMaterial),ObjectControls),ObjectControls.enableVerticalRotation(),ObjectControls.setMaxVerticalRotationAngle(e.Math.degToRad(0),Math.PI/2),ObjectControls.setDistance(-10,10),ObjectControls.setZoomSpeed(.07),
ObjectControls.setRotationSpeed(.03));this.control=this.controls[a]}},disableControl:function(){this.control.enabled=!1},toggleNextControl:function(){this.enableControl(this.getNextControlIndex())},getScreenVector:function(a){a=a.clone();var b=this.container.clientWidth/2,c=this.container.clientHeight/2;a.project(this.camera);a.x=a.x*b+b;a.y=-(a.y*c)+c;a.z=0;return a},checkSpriteInViewport:function(a){this.camera.matrixWorldInverse.getInverse(this.camera.matrixWorld);this.cameraViewProjectionMatrix.multiplyMatrices(this.camera.projectionMatrix,
this.camera.matrixWorldInverse);this.cameraFrustum.setFromMatrix(this.cameraViewProjectionMatrix);return a.visible&&this.cameraFrustum.intersectsSprite(a)},reverseDraggingDirection:function(){console.warn("reverseDragging option is deprecated. Please use rotateSpeed to indicate strength and direction");this.OrbitControls.rotateSpeed*=-1},addReticle:function(a,b){var c=new O(16777215,!0,this.options.dwellTime);c.hide();a.add(c);b.add(a);return c},rotateControlLeft:function(a){this.OrbitControls.rotateLeftStatic(a)},
rotateControlUp:function(a){this.OrbitControls.rotateUpStatic(a)},rotateControl:function(a,b){this.rotateControlLeft(a);this.rotateControlUp(b)},calculateCameraDirectionDelta:function(a){var b=this.camera.getWorldDirection(new e.Vector3);var c=b.clone();var d=this.panorama.getWorldPosition(new e.Vector3).sub(this.camera.getWorldPosition(new e.Vector3));a=a.clone();a.add(d).normalize();var g=a.clone();b.y=0;a.y=0;d=Math.atan2(a.z,a.x)-Math.atan2(b.z,b.x);d=d>Math.PI?d-2*Math.PI:d;d=d<-Math.PI?d+2*
Math.PI:d;b=Math.abs(c.angleTo(b)+(0>=c.y*g.y?g.angleTo(a):-g.angleTo(a)));b*=g.y<c.y?1:-1;return{left:d,up:b}},setControlCenter:function(a){a=void 0===a?this.options.initialLookAt:a;a=this.calculateCameraDirectionDelta(a);this.rotateControl(a.left,a.up)},tweenControlCenter:function(a,b,c){a instanceof Array&&(c=a[2],b=a[1],a=a[0]);b=void 0!==b?b:1E3;c=c||h.Easing.Exponential.Out;var d=this.calculateCameraDirectionDelta(a);a=d.left;d=d.up;var e=this.rotateControlLeft.bind(this),l=this.rotateControlUp.bind(this),
k={left:0,up:0},n=0,m=0;this.tweenLeftAnimation.stop();this.tweenUpAnimation.stop();this.tweenLeftAnimation=(new h.Tween(k)).to({left:a},b).easing(c).onUpdate(function(a){e(a.left-n);n=a.left}).start();this.tweenUpAnimation=(new h.Tween(k)).to({up:d},b).easing(c).onUpdate(function(a){l(a.up-m);m=a.up}).start()},tweenControlCenterByObject:function(a,b,c){this.tweenControlCenter(a.getWorldPosition(new e.Vector3),b,c)},onWindowResize:function(a,b){var c=this.container.classList.contains("panolens-container")||
this.container.isFullscreen;if(void 0!==a&&void 0!==b){var d=a;var e=b;this.container._width=a;this.container._height=b}else a=ma?Math.min(document.documentElement.clientWidth,window.innerWidth||0):Math.max(document.documentElement.clientWidth,window.innerWidth||0),b=ma?Math.min(document.documentElement.clientHeight,window.innerHeight||0):Math.max(document.documentElement.clientHeight,window.innerHeight||0),d=c?a:this.container.clientWidth,e=c?b:this.container.clientHeight,this.container._width=d,
this.container._height=e;this.camera.aspect=d/e;this.camera.updateProjectionMatrix();this.renderer.setSize(d,e);this.panorama&&"slider_panorama"==this.panorama.subtype&&(this.renderer.clear(),this.renderer.clearDepth(),this.fitObjectToScreen(this.panorama));(this.options.enableReticle||this.tempEnableReticle)&&this.updateReticleEvent();this.dispatchEvent({type:"window-resize",width:d,height:e});this.scene.traverse(function(a){a.dispatchEvent&&a.dispatchEvent({type:"window-resize",width:d,height:e})})},
addOutputElement:function(){var a=document.createElement("div");a.style.position="absolute";a.style.right="10px";a.style.top="10px";a.style.color="#fff";this.container.appendChild(a);this.outputDivElement=a},outputPosition:function(){var a=this.raycaster.intersectObject(this.panorama,!0);if(0<a.length){var b=new e.Vector3(-1,1,1);a=a[0].point.clone();var c=this.panorama.getWorldPosition(new e.Vector3);a.sub(c).multiply(b);this.lastTouch=a;b=a.x.toFixed(2)+", "+a.y.toFixed(2)+", "+a.z.toFixed(2);if(0!==
a.length())switch(this.options.output){case "console":return console.info(b),a;case "overlay":return this.outputDivElement.textContent=b,a;default:return a}}},onMouseDown:function(a){a.preventDefault();this.userMouse.x=0<=a.clientX?a.clientX:a.touches[0].clientX;this.userMouse.y=0<=a.clientY?a.clientY:a.touches[0].clientY;this.userMouse.type="mousedown";this.onTap(a)},onMouseMove:function(a){a.preventDefault();this.userMouse.type="mousemove";this.onTap(a)},onMouseUp:function(a){this.userMouse.type=
"mouseup";var b=this.userMouse.x>=a.clientX-this.options.clickTolerance&&this.userMouse.x<=a.clientX+this.options.clickTolerance&&this.userMouse.y>=a.clientY-this.options.clickTolerance&&this.userMouse.y<=a.clientY+this.options.clickTolerance||a.changedTouches&&this.userMouse.x>=a.changedTouches[0].clientX-this.options.clickTolerance&&this.userMouse.x<=a.changedTouches[0].clientX+this.options.clickTolerance&&this.userMouse.y>=a.changedTouches[0].clientY-this.options.clickTolerance&&this.userMouse.y<=
a.changedTouches[0].clientY+this.options.clickTolerance?"click":void 0;a&&a.target&&!a.target.classList.contains("panolens-canvas")||(a.preventDefault(),a=a.changedTouches&&1===a.changedTouches.length?this.onTap({clientX:a.changedTouches[0].clientX,clientY:a.changedTouches[0].clientY},b):this.onTap(a,b),this.userMouse.type="none",a||"click"!==b||(b=this.panorama,this.options.autoHideInfospot&&b&&b.toggleInfospotVisibility()))},onTap:function(a,b){var c=this.container.getBoundingClientRect(),d=c.top,
e=this.container,h=e.clientHeight;this.raycasterPoint.x=(a.clientX-c.left)/e.clientWidth*2-1;this.raycasterPoint.y=2*-((a.clientY-d)/h)+1;this.raycaster.setFromCamera(this.raycasterPoint,this.camera);if(this.panorama){"mousedown"!==a.type&&this.outputPosition();c=this.raycaster.intersectObjects(this.panorama.children,!0);d=this.getConvertedIntersect(c);e=0<c.length?c[0].object:void 0;"mouseup"===this.userMouse.type&&(d&&this.pressEntityObject===d&&this.pressEntityObject.dispatchEvent&&this.pressEntityObject.dispatchEvent({type:"pressstop-entity",
mouseEvent:a}),this.pressEntityObject=void 0);"mouseup"===this.userMouse.type&&(e&&this.pressObject===e&&this.pressObject.dispatchEvent&&this.pressObject.dispatchEvent({type:"pressstop",mouseEvent:a}),this.pressObject=void 0);if("click"===b)this.panorama.dispatchEvent({type:"click",intersects:c,mouseEvent:a}),d&&d.dispatchEvent&&d.dispatchEvent({type:"click-entity",mouseEvent:a}),e&&e.dispatchEvent&&e.dispatchEvent({type:"click",mouseEvent:a});else{this.panorama.dispatchEvent({type:"hover",intersects:c,
mouseEvent:a});if(this.hoverObject&&0<c.length&&this.hoverObject!==d||this.hoverObject&&0===c.length)this.hoverObject.dispatchEvent&&(this.hoverObject.dispatchEvent({type:"hoverleave",mouseEvent:a}),this.reticle.end()),this.hoverObject=void 0;d&&0<c.length&&(this.hoverObject!==d&&(this.hoverObject=d,this.hoverObject.dispatchEvent&&(this.hoverObject.dispatchEvent({type:"hoverenter",mouseEvent:a}),(this.options.autoReticleSelect&&this.options.enableReticle||this.tempEnableReticle)&&this.reticle.start(this.onTap.bind(this,
a,"click")))),"mousedown"===this.userMouse.type&&this.pressEntityObject!=d&&(this.pressEntityObject=d,this.pressEntityObject.dispatchEvent&&this.pressEntityObject.dispatchEvent({type:"pressstart-entity",mouseEvent:a})),"mousedown"===this.userMouse.type&&this.pressObject!=e&&(this.pressObject=e,this.pressObject.dispatchEvent&&this.pressObject.dispatchEvent({type:"pressstart",mouseEvent:a})),"mousemove"===this.userMouse.type||this.options.enableReticle)&&(e&&e.dispatchEvent&&e.dispatchEvent({type:"hover",
mouseEvent:a}),this.pressEntityObject&&this.pressEntityObject.dispatchEvent&&this.pressEntityObject.dispatchEvent({type:"pressmove-entity",mouseEvent:a}),this.pressObject&&this.pressObject.dispatchEvent&&this.pressObject.dispatchEvent({type:"pressmove",mouseEvent:a}));!d&&this.pressEntityObject&&this.pressEntityObject.dispatchEvent&&(this.pressEntityObject.dispatchEvent({type:"pressstop-entity",mouseEvent:a}),this.pressEntityObject=void 0);!e&&this.pressObject&&this.pressObject.dispatchEvent&&(this.pressObject.dispatchEvent({type:"pressstop",
mouseEvent:a}),this.pressObject=void 0)}if(e&&e instanceof B){if(this.infospot=e,"click"===b)return!0}else this.infospot&&this.hideInfospot();a=!this.infospot||this.infospot&&"toScene"!=this.infospot.type;this.options.autoRotate&&"mousemove"!==this.userMouse.type&&a&&(clearTimeout(this.autoRotateRequestId),this.control===this.OrbitControls&&(this.OrbitControls.autoRotate=!1,this.dispatchEvent({type:"pauseAutoRotate"}),this.autoRotateRequestId=window.setTimeout(this.enableAutoRate.bind(this),this.options.autoRotateActivationDuration)))}},
getConvertedIntersect:function(a){for(var b,c=0;c<a.length;c++)if(0<=a[c].distance&&a[c].object&&!a[c].object.passThrough&&(!a[c].object.entity||!a[c].object.entity.passThrough)){b=a[c].object.entity&&!a[c].object.entity.passThrough?a[c].object.entity:a[c].object;break}return b},hideInfospot:function(){this.infospot&&(this.infospot.onHoverEnd(),this.infospot=void 0)},onKeyDown:function(a){this.options.output&&"none"!==this.options.output&&"Control"===a.key&&(this.outputEnabled=!0)},onKeyUp:function(){this.outputEnabled=
!1},update:function(){var a=this.scene,b=this.control,c=this.OrbitControls,d=this.DeviceOrientationControls;h.update();this.updateCallbacks.forEach(function(a){return a()});c.enabled&&c.update();b===d&&d.update();var g=new e.Vector3;a.traverse(function(a){if(a instanceof B&&a.element&&(this.hoverObject===a||"none"!==a.element.style.display||a.element.left&&"none"!==a.element.left.style.display||a.element.right&&"none"!==a.element.right.style.display))if(this.checkSpriteInViewport(a)){var b=this.getScreenVector(a.getWorldPosition(g));
a.translateElement(b.x,b.y)}else a.onDismiss()}.bind(this))},renderEffect:function(a){this.renderer.setRenderTarget(null);this.renderer.clear();this.effect.render(this.scene,this.camera,this.panorama);this.effect.render(this.sceneReticle,this.camera);this.renderer.clearDepth()},renderNormal:function(a){void 0===a||a?this.renderer.setRenderTarget(this.fbo):this.renderer.setRenderTarget(null);this.renderer.clear();this.renderer.render(this.scene,this.camera);this.renderer.render(this.sceneReticle,this.camera);
this.renderer.clearDepth()},render:function(a){a=void 0===a?!0:a;this.panorama&&(this.mode==u.NORMAL?this.renderNormal(a):this.renderEffect(a))},animate:function(){ka||(this.requestAnimationId=window.requestAnimationFrame(this.animate.bind(this)));this.onChange()},onChange:function(){this.update();this.render()},registerMouseAndTouchEvents:function(){var a={passive:!1};this.container.addEventListener("mousedown",this.handlerMouseDown,a);this.container.addEventListener("mousemove",this.handlerMouseMove,
a);this.container.addEventListener("mouseup",this.handlerMouseUp,a);this.container.addEventListener("touchstart",this.handlerMouseDown,a);this.container.addEventListener("touchend",this.handlerMouseUp,a)},unregisterMouseAndTouchEvents:function(){this.container.removeEventListener("mousedown",this.handlerMouseDown,!1);this.container.removeEventListener("mousemove",this.handlerMouseMove,!1);this.container.removeEventListener("mouseup",this.handlerMouseUp,!1);this.container.removeEventListener("touchstart",
this.handlerMouseDown,!1);this.container.removeEventListener("touchend",this.handlerMouseUp,!1)},registerReticleEvent:function(){this.addUpdateCallback(this.handlerTap)},unregisterReticleEvent:function(){this.removeUpdateCallback(this.handlerTap)},updateReticleEvent:function(){var a=this.container.clientWidth/2+this.container.offsetLeft,b=this.container.clientHeight/2;this.removeUpdateCallback(this.handlerTap);this.handlerTap=this.onTap.bind(this,{clientX:a,clientY:b});this.addUpdateCallback(this.handlerTap)},
registerEventListeners:function(){window.addEventListener("resize",this.handlerWindowResize,!0);window.addEventListener("keydown",this.handlerKeyDown,!0);window.addEventListener("keyup",this.handlerKeyUp,!0)},unregisterEventListeners:function(){window.removeEventListener("resize",this.handlerWindowResize,!0);window.removeEventListener("keydown",this.handlerKeyDown,!0);window.removeEventListener("keyup",this.handlerKeyUp,!0)},dispose:function(){function a(b){for(var c=b.children.length-1;0<=c;c--)a(b.children[c]),
b.remove(b.children[c]);b instanceof n||b instanceof B?b.dispose():b.dispatchEvent&&b.dispatchEvent("dispose")}this.disableAutoRate();this.tweenLeftAnimation.stop();this.tweenUpAnimation.stop();this.unregisterEventListeners();this.fbo.dispose();this.reticleFbo.dispose();a(this.scene);this.DragControls&&this.DragControls.dispose&&this.DragControls.dispose();this.widget&&(this.widget.dispose(),this.widget=null);e.Cache&&e.Cache.enabled&&e.Cache.clear()},destroy:function(){this.dispose();this.render();
window.cancelAnimationFrame(this.requestAnimationId)},onPanoramaDispose:function(a){var b=function(b){return b.toPanorama!==a?b:b.dispose()};this.scene.traverse(function(a){a instanceof n&&(a.linkedSpots=a.linkedSpots.map(b).filter(function(a){return!!a}))});a===this.panorama&&(this.panorama=null)},loadAsyncRequest:function(a,b){b=void 0===b?function(){}:b;var c=new window.XMLHttpRequest;c.onloadend=function(a){b(a)};c.open("GET",a,!0);c.send(null)},addViewIndicator:function(){var a=this;this.loadAsyncRequest(F.ViewIndicator,
function(b){if(0!==b.loaded){b=b.target.responseXML.documentElement;b.style.width=a.viewIndicatorSize+"px";b.style.height=a.viewIndicatorSize+"px";b.style.position="absolute";b.style.top="10px";b.style.left="10px";b.style.opacity="0.5";b.style.cursor="pointer";b.id="panolens-view-indicator-container";a.container.appendChild(b);var c=b.querySelector("#indicator");a.addUpdateCallback(function(){a.radius=.225*a.viewIndicatorSize;a.currentPanoAngle=a.camera.rotation.y-e.Math.degToRad(90);a.fovAngle=e.Math.degToRad(a.camera.fov);
a.leftAngle=-a.currentPanoAngle-a.fovAngle/2;a.rightAngle=-a.currentPanoAngle+a.fovAngle/2;a.leftX=a.radius*Math.cos(a.leftAngle);a.leftY=a.radius*Math.sin(a.leftAngle);a.rightX=a.radius*Math.cos(a.rightAngle);a.rightY=a.radius*Math.sin(a.rightAngle);a.indicatorD="M "+a.leftX+" "+a.leftY+" A "+a.radius+" "+a.radius+" 0 0 1 "+a.rightX+" "+a.rightY;a.leftX&&a.leftY&&a.rightX&&a.rightY&&a.radius&&c.setAttribute("d",a.indicatorD)});b.addEventListener("mouseenter",function(){this.style.opacity="1"});b.addEventListener("mouseleave",
function(){this.style.opacity="0.5"})}})},clearAllCache:function(){e.Cache.clear()}});"105"!=e.REVISION&&console.warn("three.js version is not matched. Please consider use the target revision 105");window.TWEEN=h;p.BasicPanorama=W;p.CONTROLS=C;p.CubeTextureLoader=la;p.DataImage=F;p.EmptyPanorama=V;p.ImageLittlePlanet=aa;p.ImageLoader=ia;p.ImagePanorama=v;p.Infospot=B;p.LittlePlanet=G;p.MODES=u;p.Panorama=n;p.REVISION="11";p.Reticle=O;p.STEREOFORMAT=H;p.SliderPanorama=K;p.THREE_REVISION="105";p.THREE_VERSION=
oa;p.TextureLoader=M;p.VERSION="0.11.0";p.Viewer=ha;p.ViewerManager=Z;Object.defineProperty(p,"__esModule",{value:!0})});
